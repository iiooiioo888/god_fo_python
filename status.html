<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- Basic Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>镜像状态监控 - 数据健康检查 | 镜界</title>
    <meta name="description" content="实时监控数据源健康状态，可用性与性能指标">
    <meta name="keywords" content="监控,状态检查,数据源,实时监控,性能指标">
    <meta name="author" content="镜界平台">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📊</text></svg>">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Libraries -->
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

    <!-- Component System -->
    <script src="components/template-processor.js"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white">
    <custom-navbar></custom-navbar>

    <div class="min-h-screen">
        <!-- Page Header -->
        <header class="pt-32 pb-16 bg-gradient-to-r from-blue-900 via-purple-900 to-pink-900">
            <div class="container mx-auto px-4 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-4 flex items-center justify-center gap-4">
                    <i data-feather="activity" class="text-green-400"></i>
                    镜像状态监控中心
                </h1>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    实时监控数据源健康状态，可用性与性能指标，7×24小时全方位守护你的数据管道
                </p>
            </div>
        </header>

        <!-- Overview Stats -->
        <section class="py-12 bg-gray-900/50">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 text-center border border-green-900/30 hover:border-green-500/50 transition-all duration-300">
                        <div class="text-3xl font-bold text-green-400 mb-2" id="total-monitored">42</div>
                        <div class="text-sm text-gray-400">监控数据源</div>
                        <div class="text-xs text-green-400 mt-1 flex items-center justify-center gap-1">
                            <i data-feather="trending-up" class="w-3 h-3"></i>
                            +5 本周新增
                        </div>
                    </div>
                    <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 text-center border border-green-900/30 hover:border-green-500/50 transition-all duration-300">
                        <div class="text-3xl font-bold text-green-400 mb-2" id="avg-uptime">98.3%</div>
                        <div class="text-sm text-gray-400">平均可用率</div>
                        <div class="text-xs text-green-400 mt-1 flex items-center justify-center gap-1">
                            <i data-feather="arrow-up" class="w-3 h-3"></i>
                            +0.5% 较上月
                        </div>
                    </div>
                    <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 text-center border border-blue-900/30 hover:border-blue-500/50 transition-all duration-300">
                        <div class="text-3xl font-bold text-blue-400 mb-2" id="total-checks">24753</div>
                        <div class="text-sm text-gray-400">今日检查</div>
                        <div class="text-xs text-blue-400 mt-1 flex items-center justify-center gap-1">
                            <i data-feather="clock" class="w-3 h-3"></i>
                            实时更新
                        </div>
                    </div>
                    <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 text-center border border-yellow-900/30 hover:border-yellow-500/50 transition-all duration-300">
                        <div class="text-3xl font-bold text-red-400 mb-2" id="current-issues">3</div>
                        <div class="text-sm text-gray-400">当前问题</div>
                        <div class="text-xs text-red-400 mt-1 flex items-center justify-center gap-1">
                            <i data-feather="alert-triangle" class="w-3 h-3"></i>
                            需立即关注
                        </div>
                    </div>
                </div>

                <!-- Status Update Time -->
                <div class="text-center text-sm text-gray-400 bg-gray-800/30 rounded-lg p-4 border border-gray-700/30">
                    <i data-feather="refresh-cw" class="inline mr-2 w-4 h-4"></i>
                    数据最后更新时间: <span id="last-update">2024-10-28 14:42:15</span>
                    <button onclick="refreshData()" class="ml-4 text-blue-400 hover:text-blue-300">
                        <i data-feather="refresh-cw" class="w-4 h-4"></i> 手动刷新
                    </button>
                </div>
            </div>
        </section>

        <!-- Status Charts -->
        <section class="py-12">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

                    <!-- Uptime History Chart -->
                    <div class="lg:col-span-2 bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                        <h3 class="text-xl font-semibold mb-6 flex items-center gap-2">
                            <i data-feather="trending-up" class="text-green-400"></i>
                            7天可用率历史
                        </h3>
                        <div id="uptime-chart" style="height: 400px;"></div>
                    </div>

                    <!-- Status Distribution -->
                    <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                        <h3 class="text-xl font-semibold mb-6 flex items-center gap-2">
                            <i data-feather="pie-chart" class="text-blue-400"></i>
                            状态分布
                        </h3>
                        <div id="status-distribution-chart" style="height: 300px;"></div>

                        <!-- Status Legend -->
                        <div class="mt-4 space-y-2 text-sm">
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                                <span>正常 (37/42)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                                <span>需要关注 (2/42)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 bg-red-400 rounded-full"></div>
                                <span>故障状态 (3/42)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Status Monitoring Grid -->
        <section class="py-12">
            <div class="container mx-auto px-4">

                <!-- Filter and Search -->
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700 mb-8">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                        <h3 class="text-xl font-semibold">数据源状态详情</h3>
                        <div class="flex gap-4 items-center flex-1 max-w-md">
                            <input type="text" placeholder="搜索数据源..." class="flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white" id="status-search">
                            <select class="px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" id="status-filter">
                                <option>全部状态</option>
                                <option>🟢 正常</option>
                                <option>🟡 需要关注</option>
                                <option>🔴 故障</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Data Sources Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="status-grid">
                    <!-- Data source status cards will be populated by JavaScript -->
                </div>

                <!-- Pagination -->
                <div class="mt-12 flex justify-center">
                    <nav class="flex items-center gap-2">
                        <a href="#" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors">上一页</a>
                        <a href="#" class="px-4 py-2 bg-blue-600 rounded-lg">1</a>
                        <a href="#" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors">2</a>
                        <a href="#" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors disabled">...</a>
                        <a href="#" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors">5</a>
                        <a href="#" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors">下一页</a>
                    </nav>
                </div>
            </div>
        </section>

        <!-- Global Alerts Section -->
        <section class="py-12 bg-red-900/10">
            <div class="container mx-auto px-4">
                <div class="bg-red-900/20 backdrop-blur-sm rounded-xl border border-red-500/30 p-6">
                    <h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-feather="alert-triangle" class="text-red-400"></i>
                        系统告警 (需要立即处理)
                    </h3>

                    <div class="space-y-4" id="global-alerts">
                        <div class="bg-red-900/30 rounded-lg p-4 border border-red-500/50">
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-red-500/20 rounded-full flex items-center justify-center">
                                        <i data-feather="x-circle" class="text-red-400 w-4 h-4"></i>
                                    </div>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-red-400">无法找到 NASA 数据源</h4>
                                    <p class="text-sm text-gray-300 mt-1">最后检查时间: 2024-10-28 13:42:15 | 持续时间: 2小时43分钟</p>
                                    <p class="text-sm text-gray-400 mt-2">错误详情: 网络超时，已尝试3次重连</p>
                                    <div class="flex gap-2 mt-3">
                                        <button onclick="retryConnection('nasa-api')" class="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors">重试连接</button>
                                        <button onclick="acknowledgeAlert('nasa-api')" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded text-sm transition-colors">标记已读</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-yellow-900/30 rounded-lg p-4 border border-yellow-500/50">
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0">
                                    <div class="w-8 h-8 bg-yellow-500/20 rounded-full flex items-center justify-center">
                                        <i data-feather="alert-circle" class="text-yellow-400 w-4 h-4"></i>
                                    </div>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-yellow-400">Pixabay API 响应缓慢</h4>
                                    <p class="text-sm text-gray-300 mt-1">最后检查时间: 2024-10-28 14:15:30 | 平均响应时间: 8.2秒</p>
                                    <p class="text-sm text-gray-400 mt-2">性能下降，可能影响数据采集效率</p>
                                    <div class="flex gap-2 mt-3">
                                        <button onclick="investigatePerformance('pixabay')" class="px-3 py-1 bg-yellow-600 hover:bg-yellow-700 rounded text-sm transition-colors">调查问题</button>
                                        <button onclick="dismissAlert('pixabay')" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded text-sm transition-colors">忽略</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Performance Metrics Section -->
        <section class="py-12">
            <div class="container mx-auto px-4">
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                    <h3 class="text-xl font-semibold mb-6 flex items-center gap-2">
                        <i data-feather="bar-chart-3" class="text-purple-400"></i>
                        性能指标详情
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Response Time Metrics -->
                        <div class="space-y-4">
                            <h4 class="font-semibold text-lg text-purple-400">响应时间</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">平均响应时间</span>
                                    <span class="text-white font-medium">2.4秒</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">最快响应</span>
                                    <span class="text-green-400 font-medium">0.8秒</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">最慢响应</span>
                                    <span class="text-red-400 font-medium">15.7秒</span>
                                </div>
                            </div>
                        </div>

                        <!-- Error Rate Metrics -->
                        <div class="space-y-4">
                            <h4 class="font-semibold text-lg text-red-400">错误率统计</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">今日错误率</span>
                                    <span class="text-white font-medium">1.9%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">网络超时</span>
                                    <span class="text-yellow-400 font-medium">27次</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">服务器错误</span>
                                    <span class="text-red-400 font-medium">8次</span>
                                </div>
                            </div>
                        </div>

                        <!-- Data Throughput -->
                        <div class="space-y-4">
                            <h4 class="font-semibold text-lg text-blue-400">数据吞吐量</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">今日处理量</span>
                                    <span class="text-white font-medium">15.2GB</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">实时传输速</span>
                                    <span class="text-green-400 font-medium">245KB/s</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">缓存命中率</span>
                                    <span class="text-purple-400 font-medium">89.5%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <custom-footer></custom-footer>

    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script src="script.js"></script>
    <script>
        feather.replace();

        // Status monitoring data
        let statusData = [
            {
                id: 1,
                name: "Unsplash 高清图片库",
                description: "高质量免费商用图片源，支持API调用",
                status: "🟢 正常",
                uptime: 99.8,
                lastCheck: "2分钟前",
                responseTime: "0.8秒",
                region: "全球",
                type: "图片API",
                issues: [],
                history: [99.9, 99.8, 99.7, 99.8, 99.9, 99.8, 99.8]
            },
            {
                id: 2,
                name: "Pexels 视频素材库",
                description: "免费4K视频素材，定期更新高质量视频",
                status: "🟢 正常",
                uptime: 98.5,
                lastCheck: "1分钟前",
                responseTime: "1.2秒",
                region: "美洲",
                type: "视频API",
                issues: ["上周维护导致短暂中断"],
                history: [98.2, 98.1, 98.3, 98.5, 98.4, 98.6, 98.5]
            },
            {
                id: 3,
                name: "NASA 图像数据库",
                description: "美国宇航局公开图像数据库",
                status: "🔴 故障",
                uptime: 78.3,
                lastCheck: "45分钟前",
                responseTime: "超时",
                region: "北美",
                type: "公开API",
                issues: ["网络连接失败", "正在调查"],
                history: [88.1, 85.2, 82.4, 78.3, 78.3, 78.3, 78.3]
            },
            {
                id: 4,
                name: "Pixabay 多媒体库",
                description: "免费图片和视频素材，支持商业使用",
                status: "🟡 需要关注",
                uptime: 96.7,
                lastCheck: "3分钟前",
                responseTime: "8.2秒",
                region: "欧洲",
                type: "媒体API",
                issues: ["响应时间变慢"],
                history: [97.2, 97.1, 96.8, 96.5, 96.7, 96.7, 96.7]
            },
            {
                id: 5,
                name: "Getty Images 商业库",
                description: "全球领先的商业图片库，提供专业级图片和视频素材",
                status: "🟢 正常",
                uptime: 99.2,
                lastCheck: "5分钟前",
                responseTime: "2.1秒",
                region: "全球",
                type: "商业API",
                issues: [],
                history: [99.0, 99.1, 99.3, 99.2, 99.2, 99.1, 99.2]
            },
            {
                id: 6,
                name: "Flickr 公共图片库",
                description: "雅虎旗下图片分享平台，提供海量用户上传图片",
                status: "🟢 正常",
                uptime: 97.8,
                lastCheck: "4分钟前",
                responseTime: "3.5秒",
                region: "亚洲",
                type: "用户生成内容",
                issues: [],
                history: [98.1, 98.0, 97.9, 97.8, 97.6, 97.8, 97.8]
            },
            {
                id: 7,
                name: "Giphy GIF动画库",
                description: "全球最大的GIF动画图片库",
                status: "🟢 正常",
                uptime: 99.5,
                lastCheck: "1分钟前",
                responseTime: "0.6秒",
                region: "美国",
                type: "GIF动画",
                issues: [],
                history: [99.6, 99.4, 99.3, 99.5, 99.5, 99.4, 99.5]
            }
        ];

        let currentFilter = 'all';

        // Initialize charts and data
        function initStatusPage() {
            initCharts();
            renderStatusGrid();
            updateStatusStats();

            // Auto refresh data every 30 seconds
            setInterval(refreshData, 30000);
        }

        function initCharts() {
            // Uptime History Chart
            const uptimeChart = echarts.init(document.getElementById('uptime-chart'));

            // Calculate average uptime over time
            const chartData = [];
            for (let day = 6; day >= 0; day--) {
                const date = new Date();
                date.setDate(date.getDate() - day);
                const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });

                // Calculate average uptime for this day
                const averageUptime = statusData.reduce((acc, item) => {
                    const uptimes = item.history.slice(day, day + 7);
                    return acc + (uptimes.reduce((sum, u) => sum + u, 0) / uptimes.length || item.uptime);
                }, 0) / statusData.length;

                chartData.push({
                    date: dateStr,
                    uptime: averageUptime.toFixed(1)
                });
            }

            const uptimeOption = {
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c}%'
                },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'category',
                    data: chartData.map(d => d.date),
                    axisLabel: { color: '#9ca3af' }
                },
                yAxis: {
                    type: 'value',
                    min: 95,
                    max: 100,
                    axisLabel: {
                        color: '#9ca3af',
                        formatter: '{value}%'
                    }
                },
                series: [{
                    name: '可用率',
                    type: 'line',
                    data: chartData.map(d => d.uptime),
                    smooth: true,
                    lineStyle: { color: '#10b981', width: 2 },
                    itemStyle: { color: '#10b981' },
                    areaStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 0, x2: 0, y2: 1,
                            colorStops: [{
                                offset: 0, color: 'rgba(16, 185, 129, 0.3)'
                            }, {
                                offset: 1, color: 'rgba(16, 185, 129, 0.05)'
                            }]
                        }
                    }
                }]
            };
            uptimeChart.setOption(uptimeOption);

            // Status Distribution Chart
            const distributionChart = echarts.init(document.getElementById('status-distribution-chart'));

            const statusCounts = {};
            statusData.forEach(item => {
                if (item.status.includes('正常')) {
                    statusCounts['正常'] = (statusCounts['正常'] || 0) + 1;
                } else if (item.status.includes('需要关注')) {
                    statusCounts['需要关注'] = (statusCounts['需要关注'] || 0) + 1;
                } else if (item.status.includes('故障')) {
                    statusCounts['故障'] = (statusCounts['故障'] || 0) + 1;
                }
            });

            const distributionOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    bottom: '0%',
                    textStyle: { color: '#9ca3af' }
                },
                series: [{
                    name: '状态分布',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    center: ['50%', '45%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 8,
                        borderColor: '#1f2937',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: 14,
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        {
                            value: statusCounts['正常'] || 0,
                            name: '正常',
                            itemStyle: { color: '#10b981' }
                        },
                        {
                            value: statusCounts['需要关注'] || 0,
                            name: '需要关注',
                            itemStyle: { color: '#f59e0b' }
                        },
                        {
                            value: statusCounts['故障'] || 0,
                            name: '故障',
                            itemStyle: { color: '#ef4444' }
                        }
                    ]
                }]
            };
            distributionChart.setOption(distributionOption);

            // Handle window resize
            window.addEventListener('resize', function() {
                uptimeChart.resize();
                distributionChart.resize();
            });
        }

        function renderStatusGrid(searchTerm = '', statusFilter = 'all') {
            const grid = document.getElementById('status-grid');
            const filteredData = statusData.filter(item => {
                const matchesSearch = searchTerm === '' ||
                    item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.description.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesStatus = statusFilter === 'all' ||
                    (statusFilter === '🟢 正常' && item.status.includes('🟢')) ||
                    (statusFilter === '🟡 需要关注' && item.status.includes('🟡')) ||
                    (statusFilter === '🔴 故障' && item.status.includes('🔴'));
                return matchesSearch && matchesStatus;
            });

            grid.innerHTML = filteredData.length === 0 ?
                '<div class="col-span-full text-center py-12 text-gray-400">未找到匹配的数据源</div>' :
                filteredData.map(item => createStatusCard(item)).join('');

            feather.replace();
        }

        function createStatusCard(item) {
            const statusColor = item.status.includes('🟢') ? 'border-green-500/50 bg-green-900/10' :
                              item.status.includes('🟡') ? 'border-yellow-500/50 bg-yellow-900/10' :
                              'border-red-500/50 bg-red-900/10';

            const responseColor = item.responseTime.includes('超时') ? 'text-red-400' :
                                parseFloat(item.responseTime) > 5 ? 'text-yellow-400' :
                                'text-green-400';

            const issuesText = item.issues.length > 0 ?
                `<div class="mt-3 text-xs text-yellow-400">
                    <i data-feather="alert-triangle" class="inline w-3 h-3 mr-1"></i>
                    ${item.issues.join(' • ')}
                 </div>` : '';

            return `
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700 ${statusColor} hover:border-gray-600 transition-all duration-300 group">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-semibold flex items-center gap-2">
                            ${item.name}
                            <span class="text-xs px-2 py-1 rounded-full ${statusColor} ${item.status.includes('🟢') ? 'text-green-400' : item.status.includes('🟡') ? 'text-yellow-400' : 'text-red-400'}">
                                ${item.status}
                            </span>
                        </h3>
                        <div class="text-right text-sm text-gray-400">
                            <div>Uptime: ${item.uptime}%</div>
                            <div class="mt-1">Region: ${item.region}</div>
                        </div>
                    </div>

                    <p class="text-gray-400 text-sm mb-4">${item.description}</p>

                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-gray-700/50 rounded-lg p-3">
                            <div class="text-xs text-gray-400 mb-1">响应时间</div>
                            <div class="text-sm font-semibold ${responseColor}">${item.responseTime}</div>
                        </div>
                        <div class="bg-gray-700/50 rounded-lg p-3">
                            <div class="text-xs text-gray-400 mb-1">最后检查</div>
                            <div class="text-sm font-semibold text-blue-400">${item.lastCheck}</div>
                        </div>
                    </div>

                    <div class="flex justify-between items-center">
                        <span class="text-xs px-2 py-1 bg-gray-700 rounded text-gray-300">${item.type}</span>
                        <div class="flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="viewDetails(${item.id})" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm transition-colors">详情</button>
                            <button onclick="testConnection(${item.id})" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 rounded text-sm transition-colors">测试</button>
                        </div>
                    </div>

                    ${issuesText}
                </div>
            `;
        }

        function updateStatusStats() {
            const totalMonitored = statusData.length;
            const avgUptime = statusData.reduce((acc, item) => acc + item.uptime, 0) / totalMonitored;
            const totalChecks = Math.floor(Math.random() * 10000) + 20000;
            const currentIssues = statusData.filter(item => item.status.includes('🔴') || item.status.includes('🟡')).length;

            document.getElementById('total-monitored').textContent = totalMonitored;
            document.getElementById('avg-uptime').textContent = avgUptime.toFixed(1) + '%';
            document.getElementById('total-checks').textContent = totalChecks.toLocaleString();
            document.getElementById('current-issues').textContent = currentIssues;

            document.getElementById('last-update').textContent = new Date().toLocaleString('zh-CN');
        }

        // Event handlers
        function refreshData() {
            // Simulate refresh
            updateStatusStats();
            renderStatusGrid(
                document.getElementById('status-search').value,
                document.getElementById('status-filter').value
            );

            showToast('数据已刷新', 'success');
        }

        function retryConnection(dataSource) {
            showToast(`正在重试连接 ${dataSource}...`, 'info');
            setTimeout(() => {
                showToast('连接重试完成', 'success');
            }, 2000);
        }

        function acknowledgeAlert(alertId) {
            // Remove alert from UI
            const alertElement = document.querySelector(`[onclick*="acknowledgeAlert('${alertId}')"]`).closest('.bg-red-900\\/30, .bg-yellow-900\\/30');
            if (alertElement) {
                alertElement.style.opacity = '0';
                setTimeout(() => alertElement.remove(), 300);
            }
            showToast('告警已确认', 'success');
        }

        function investigatePerformance(dataSource) {
            showToast(`开始调查 ${dataSource} 性能问题...`, 'info');
        }

        function dismissAlert(dataSource) {
            acknowledgeAlert(dataSource);
        }

        function viewDetails(id) {
            const item = statusData.find(item => item.id === id);
            if (item) {
                // In a real app, this would navigate to a details page
                showToast(`查看 ${item.name} 详情`, 'info');
            }
        }

        function testConnection(id) {
            const item = statusData.find(item => item.id === id);
            if (item) {
                showToast(`正在测试 ${item.name} 连接...`, 'info');
                setTimeout(() => {
                    showToast(`连接测试完成: ${item.status}`, item.status.includes('🟢') ? 'success' : 'warning');
                }, 1500);
            }
        }

        // Search and filter handlers
        document.getElementById('status-search').addEventListener('input', function() {
            renderStatusGrid(this.value, document.getElementById('status-filter').value);
        });

        document.getElementById('status-filter').addEventListener('change', function() {
            renderStatusGrid(document.getElementById('status-search').value, this.value);
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', initStatusPage);
    </script>
</body>
</html>
