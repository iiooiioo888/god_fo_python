<!-- LEGACY FILE NOTICE -->
> âš ï¸ æ­¤æª”æ¡ˆç‚ºèˆŠç‰ˆå‚™ä»½ï¼Œå·²è¢«æ–°æª”å–ä»£ï¼š [ch7-6-APIè¯¦ç»†è§„èŒƒ.md](ch7-6-APIè¯¦ç»†è§„èŒƒ.md)\n> å‚™ä»½æ™‚é–“ï¼š2025-10-31 12:28:26\n
---

**[â† è¿”å›ç¬¬7ç« é¦–é ](ch7-index.md)**

---

### 7.6 APIè¯¦ç»†è§„èŒƒ

#### 7.6.1 åˆè§„æ€§æ£€æŸ¥API

**æ£€æŸ¥æ•°æ®æºåˆè§„æ€§ (POST /api/v1/compliance/check)**

*è¯·æ±‚ç¤ºä¾‹:*
```http
POST /api/v1/compliance/check HTTP/1.1
Host: dcsc.mirror-realm.com
Authorization: Bearer <access_token>
Content-Type: application/json

{
  "data_source_id": "ds-7a8b9c0d",
  "include_content": true
}
```

*æˆåŠŸå“åº”ç¤ºä¾‹:*
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "data_source_id": "ds-7a8b9c0d",
  "project_id": "proj-123",
  "status": "warning",
  "total_rules": 15,
  "passed_rules": 12,
  "failed_rules": 2,
  "not_applicable_rules": 1,
  "critical_issues": 0,
  "results": [
    {
      "rule_id": "rule-gdpr-001",
      "rule_name": "ä¸ªäººæ•°æ®æ ‡è¯†æ£€æŸ¥",
      "applicable": true,
      "passed": false,
      "message": "æ£€æµ‹åˆ°æ½œåœ¨çš„ä¸ªäººèº«ä»½ä¿¡æ¯",
      "details": {
        "findings": [
          {
            "pattern_id": "pattern-email",
            "pattern_name": "ç”µå­é‚®ä»¶åœ°å€",
            "data_category": "personal",
            "start": 125,
            "end": 150,
            "value": "user@example.com",
            "context": "è”ç³»ä¿¡æ¯: user@example.com"
          }
        ]
      }
    },
    {
      "rule_id": "rule-gdpr-002",
      "rule_name": "æ•°æ®æœ€å°åŒ–æ£€æŸ¥",
      "applicable": true,
      "passed": true,
      "message": "è§„åˆ™é€šè¿‡: æ•°æ®æœ€å°åŒ–è¦æ±‚å·²æ»¡è¶³"
    }
  ],
  "suggestions": [
    "å¿…é¡»è§£å†³: ä¸ªäººæ•°æ®æ ‡è¯†æ£€æŸ¥ - æ£€æµ‹åˆ°æ½œåœ¨çš„ä¸ªäººèº«ä»½ä¿¡æ¯",
    "å»ºè®®æ”¹è¿›: æ£€æµ‹åˆ° 2 ä¸ªå¯ä¼˜åŒ–çš„åˆè§„æ€§é—®é¢˜"
  ],
  "timestamp": "2023-06-15T10:30:45Z"
}
```

#### 7.6.2 æ•æ„Ÿæ•°æ®æ£€æµ‹API

**æ£€æµ‹æ•æ„Ÿæ•°æ® (POST /api/v1/data:detect-sensitive)**

*è¯·æ±‚ç¤ºä¾‹:*
```http
POST /api/v1/data:detect-sensitive HTTP/1.1
Host: dcsc.mirror-realm.com
Authorization: Bearer <access_token>
Content-Type: application/json

{
  "data": {
    "name": "John Doe",
    "email": "john.doe@example.com",
    "phone": "+1-555-123-4567",
    "address": "123 Main St, Anytown, USA"
  },
  "context": {
    "categories": ["contact", "personal"],
    "regions": ["us"]
  }
}
```

*æˆåŠŸå“åº”ç¤ºä¾‹:*
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "data_hash": "d41d8cd98f00b204e9800998ecf8427e",
  "total_patterns": 8,
  "findings": [
    {
      "pattern_id": "pattern-name",
      "pattern_name": "ä¸ªäººå§“å",
      "data_category": "personal",
      "value": "John Doe",
      "context": "name: John Doe",
      "path": "name",
      "type": "value"
    },
    {
      "pattern_id": "pattern-email",
      "pattern_name": "ç”µå­é‚®ä»¶åœ°å€",
      "data_category": "personal",
      "value": "john.doe@example.com",
      "context": "email: john.doe@example.com",
      "path": "email",
      "type": "value"
    },
    {
      "pattern_id": "pattern-phone",
      "pattern_name": "ç”µè¯å·ç ",
      "data_category": "personal",
      "value": "+1-555-123-4567",
      "context": "phone: +1-555-123-4567",
      "path": "phone",
      "type": "value"
    }
  ],
  "context": {
    "categories": ["contact", "personal"],
    "regions": ["us"]
  },
  "severity": "high",
  "timestamp": "2023-06-15T10:35:20Z"
}
```

#### 7.6.3 ç”¨æˆ·åŒæ„ç®¡ç†API

**è®°å½•ç”¨æˆ·åŒæ„ (POST /api/v1/consents)**

*è¯·æ±‚ç¤ºä¾‹:*
```http
POST /api/v1/consents HTTP/1.1
Host: dcsc.mirror-realm.com
Authorization: Bearer <access_token>
Content-Type: application/json

{
  "user_id": "user-123",
  "data_source_id": "ds-7a8b9c0d",
  "consent_type": "data_processing",
  "consent_value": true,
  "consent_details": {
    "purpose": "æ•°æ®é‡‡é›†ä¸å¤„ç†",
    "data_types": ["personal", "contact"],
    "retention_period": "2 years"
  }
}
```

*æˆåŠŸå“åº”ç¤ºä¾‹:*
```http
HTTP/1.1 201 Created
Content-Type: application/json
Location: /api/v1/consents/consent-1a2b3c4d

{
  "id": "consent-1a2b3c4d",
  "user_id": "user-123",
  "data_source_id": "ds-7a8b9c0d",
  "project_id": "proj-123",
  "consent_type": "data_processing",
  "consent_value": true,
  "consent_details": {
    "purpose": "æ•°æ®é‡‡é›†ä¸å¤„ç†",
    "data_types": ["personal", "contact"],
    "retention_period": "2 years"
  },
  "consent_timestamp": "2023-06-15T10:30:45Z",
  "revoked": false
}
```

**è·å–ç”¨æˆ·åŒæ„è®°å½• (GET /api/v1/consents/{user_id})**

*è¯·æ±‚ç¤ºä¾‹:*
```http
GET /api/v1/consents/user-123?data_source_id=ds-7a8b9c0d HTTP/1.1
Host: dcsc.mirror-realm.com
Authorization: Bearer <access_token>
```

*æˆåŠŸå“åº”ç¤ºä¾‹:*
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "items": [
    {
      "id": "consent-1a2b3c4d",
      "user_id": "user-123",
      "data_source_id": "ds-7a8b9c0d",
      "project_id": "proj-123",
      "consent_type": "data_processing",
      "consent_value": true,
      "consent_details": {
        "purpose": "æ•°æ®é‡‡é›†ä¸å¤„ç†",
        "data_types": ["personal", "contact"],
        "retention_period": "2 years"
      },
      "consent_timestamp": "2023-06-15T10:30:45Z",
      "revoked": false
    },
    {
      "id": "consent-5e6f7g8h",
      "user_id": "user-123",
      "data_source_id": "ds-7a8b9c0d",
      "project_id": "proj-123",
      "consent_type": "data_sharing",
      "consent_value": false,
      "consent_details": {
        "purpose": "ä¸ç¬¬ä¸‰æ–¹å…±äº«æ•°æ®",
        "data_types": ["personal"],
        "retention_period": "1 year"
      },
      "consent_timestamp": "2023-06-10T08:15:30Z",
      "revoked": true,
      "revoked_at": "2023-06-12T14:20:15Z"
    }
  ],
  "total": 2
}
```

---

## ğŸ“‘ ç›¸å…³ç« èŠ‚

| å‰åº | å½“å‰ | åç»­ |
|-----|------|------|
| [7.5](ch7-5.md) | **7.6** | [7.7](ch7-7.md) |

**å¿«é€Ÿé“¾æ¥ï¼š**
- [â† è¿”å›ç¬¬7ç« é¦–é ](ch7-index.md)
