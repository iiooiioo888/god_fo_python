# 🔧 鏡界平台 - 中間件與技術棧一覽表

> **快速查閱各模組使用的中間件與技術**  
> **最後更新：2025-10-31**

---

## 📊 核心中間件總覽

### 資料庫層

| 中間件 | 用途 | 使用模組 |
|--------|------|----------|
| **PostgreSQL** | 元資料、關係型資料 | Ch1, Ch4, Ch7, Ch9, Ch11, Ch12 |
| **MongoDB** | 爬蟲資料、文檔儲存 | Ch2, Ch8 |
| **Redis** | 快取、隊列、分布式鎖 | Ch1-Ch12（全部） |
| **Elasticsearch** | 全文搜尋、日誌 | Ch1, Ch8, Ch9 |
| **ClickHouse** | 實時OLAP分析 | Ch10 |
| **InfluxDB** | 時序資料、監控指標 | Ch3, Ch10 |

### 消息與隊列

| 中間件 | 用途 | 使用模組 |
|--------|------|----------|
| **Apache Kafka** | 事件流、資料管道 | Ch8, Ch10, Ch11 |
| **RabbitMQ** | 任務分發、事件通知 | Ch1, Ch4, Ch11 |
| **Celery** | 異步任務執行 | Ch4, Ch5, Ch6, Ch11 |

### 計算與調度

| 中間件 | 用途 | 使用模組 |
|--------|------|----------|
| **Apache Flink** | 流式資料處理 | Ch10 |
| **Apache Airflow** | 工作流調度 | Ch4, Ch11 |
| **Kubernetes** | 容器編排 | Ch4, Ch8, Ch9, Ch11 |
| **Docker** | 容器化 | Ch1-Ch12（全部） |

### 監控與觀測

| 中間件 | 用途 | 使用模組 |
|--------|------|----------|
| **Prometheus** | 指標採集 | Ch1, Ch3, Ch9, Ch11 |
| **Grafana** | 監控視覺化 | Ch1, Ch3, Ch9, Ch10-Ch12 |
| **ELK Stack** | 日誌管理 | Ch4, Ch7, Ch9 |
| **Jaeger** | 分布式追蹤 | Ch9 |

---

## 🎯 按模組分類

### Ch1: 資料源註冊中心

| 類別 | 技術 |
|------|------|
| **資料庫** | PostgreSQL, Redis |
| **搜尋** | Elasticsearch |
| **消息** | RabbitMQ, Kafka |
| **認證** | OAuth2, JWT |
| **監控** | Prometheus, Grafana |

### Ch2: 網站指紋分析引擎

| 類別 | 技術 |
|------|------|
| **資料庫** | MongoDB, Redis |
| **HTTP** | Requests, aiohttp |
| **解析** | BeautifulSoup, lxml |
| **機器學習** | scikit-learn |
| **爬蟲** | Scrapy |

### Ch3: 資料源健康監測系統

| 類別 | 技術 |
|------|------|
| **時序資料庫** | InfluxDB, Prometheus |
| **監控** | Prometheus, Grafana |
| **告警** | Alertmanager |
| **通知** | Email, Slack, DingTalk |
| **任務調度** | Celery, APScheduler |
| **隊列** | Redis, RabbitMQ |

### Ch4: 資料處理工作流引擎

| 類別 | 技術 |
|------|------|
| **工作流** | Apache Airflow, Prefect |
| **任務隊列** | Celery |
| **消息** | RabbitMQ, Redis |
| **資料庫** | PostgreSQL |
| **分布式鎖** | Redis, Zookeeper |
| **日誌** | ELK Stack |
| **容器** | Docker, Kubernetes |

### Ch5: 自動化媒體處理管道

| 類別 | 技術 |
|------|------|
| **影片處理** | FFmpeg |
| **圖片處理** | Pillow, OpenCV |
| **AI 模型** | TensorFlow, PyTorch |
| **GPU** | CUDA, cuDNN |
| **儲存** | NAS, S3, MinIO |
| **任務隊列** | Celery, RQ |
| **快取** | Redis |

### Ch6: AI 輔助開發系統

| 類別 | 技術 |
|------|------|
| **LLM** | OpenAI, Claude, Gemini |
| **向量資料庫** | Pinecone, Milvus, Weaviate |
| **Embedding** | OpenAI, Sentence Transformers |
| **代碼解析** | Tree-sitter, AST |
| **靜態分析** | Pylint, ESLint |
| **快取** | Redis |
| **隊列** | Celery |

### Ch7: 資料合規與安全中心

| 類別 | 技術 |
|------|------|
| **加密** | AES-256, RSA |
| **密鑰管理** | HashiCorp Vault |
| **認證** | OAuth2, OIDC, SAML |
| **審計** | ELK Stack |
| **脫敏** | Presidio |
| **規則引擎** | Drools |
| **監控** | SIEM 系統 |

### Ch8: 分布式爬蟲集群管理系統

| 類別 | 技術 |
|------|------|
| **爬蟲框架** | Scrapy, Scrapy-Redis |
| **任務隊列** | Redis, Kafka |
| **去重** | Redis, Bloom Filter |
| **代理池** | ProxyPool |
| **瀏覽器** | Selenium, Playwright |
| **容器** | Docker, Kubernetes |
| **儲存** | MongoDB, Elasticsearch |
| **監控** | Gerapy, Scrapy Dashboard |

### Ch9: 系統整合與部署

| 類別 | 技術 |
|------|------|
| **容器化** | Docker, Docker Compose |
| **編排** | Kubernetes |
| **CI/CD** | GitLab CI, Jenkins, GitHub Actions |
| **API 閘道** | Kong, Nginx, Traefik |
| **服務網格** | Istio, Linkerd |
| **監控** | Prometheus, Grafana |
| **日誌** | ELK, Loki |
| **追蹤** | Jaeger, Zipkin |

### Ch10: 實時數據處理引擎

| 類別 | 技術 |
|------|------|
| **流處理** | Apache Flink, Kafka Streams |
| **消息隊列** | Apache Kafka |
| **狀態儲存** | RocksDB |
| **實時OLAP** | ClickHouse |
| **時序資料庫** | InfluxDB, TimescaleDB |
| **視覺化** | Grafana, Superset |
| **Schema** | Confluent Schema Registry |

### Ch11: 智能調度與資源管理系統

| 類別 | 技術 |
|------|------|
| **調度器** | Apache Airflow, Prefect, Temporal |
| **編排** | Kubernetes Scheduler |
| **資源管理** | Kubernetes HPA/VPA |
| **隊列** | Celery, RabbitMQ |
| **協調** | Zookeeper, etcd |
| **監控** | Prometheus, Grafana |
| **告警** | Alertmanager |

### Ch12: 數據質量管理中心

| 類別 | 技術 |
|------|------|
| **質量框架** | Great Expectations, Apache Griffin |
| **資料處理** | Pandas, Dask, PySpark |
| **規則引擎** | Drools |
| **異常檢測** | Isolation Forest, LSTM |
| **血緣追蹤** | Apache Atlas, OpenLineage |
| **儲存** | PostgreSQL, MongoDB |
| **視覺化** | Grafana, Superset |

---

## 🔗 中間件依賴關係

### 高頻使用（8+ 模組）

| 中間件 | 使用模組數 | 類別 |
|--------|-----------|------|
| **Redis** | 12 | 通用快取/鎖 |
| **Docker** | 12 | 容器化 |
| **Grafana** | 10 | 監控視覺化 |
| **Prometheus** | 8 | 指標採集 |

### 中頻使用（4-7 模組）

| 中間件 | 使用模組數 | 類別 |
|--------|-----------|------|
| **PostgreSQL** | 6 | 關係型資料庫 |
| **Celery** | 5 | 異步任務 |
| **Kubernetes** | 5 | 容器編排 |
| **ELK Stack** | 4 | 日誌管理 |

### 專用中間件（1-3 模組）

| 中間件 | 使用模組 | 用途 |
|--------|---------|------|
| **Apache Flink** | Ch10 | 流式處理 |
| **Apache Airflow** | Ch4, Ch11 | 工作流調度 |
| **MongoDB** | Ch2, Ch8 | 文檔儲存 |
| **Elasticsearch** | Ch1, Ch8, Ch9 | 搜尋引擎 |
| **FFmpeg** | Ch5 | 影片處理 |
| **OpenAI API** | Ch6 | LLM 服務 |

---

## 📈 技術棧成熟度評估

### 穩定生產級（⭐⭐⭐⭐⭐）

- Redis
- PostgreSQL
- Nginx
- Docker
- Kubernetes
- Prometheus
- Grafana
- Elasticsearch
- Kafka

### 成熟可用（⭐⭐⭐⭐）

- MongoDB
- RabbitMQ
- Celery
- Apache Airflow
- FFmpeg
- Scrapy
- ELK Stack

### 新興技術（⭐⭐⭐）

- Apache Flink
- ClickHouse
- Istio
- Great Expectations
- Temporal

---

## 💰 開源 vs 商業

### 完全開源

| 中間件 | 授權 |
|--------|------|
| PostgreSQL | PostgreSQL License |
| MongoDB | SSPL |
| Redis | BSD |
| Elasticsearch | SSPL (7.11+) |
| Kafka | Apache 2.0 |
| Flink | Apache 2.0 |
| Kubernetes | Apache 2.0 |
| Docker | Apache 2.0 |

### 開源 + 商業版

| 中間件 | 開源版 | 商業版 |
|--------|-------|--------|
| ClickHouse | ✅ Apache 2.0 | ClickHouse Cloud |
| Grafana | ✅ AGPL | Grafana Enterprise |
| Kong | ✅ Apache 2.0 | Kong Enterprise |
| Vault | ✅ MPL 2.0 | HashiCorp Vault Enterprise |

### 商業 API 服務

| 服務 | 類型 | 定價 |
|------|------|------|
| OpenAI API | 按使用量 | $0.002/1K tokens |
| Claude API | 按使用量 | $0.008/1K tokens |
| Pinecone | Freemium | 免費 + 付費方案 |

---

## 🎯 部署架構建議

### 最小化部署（開發/測試）

```yaml
必需組件:
  - PostgreSQL (單節點)
  - Redis (單節點)
  - Docker
  
可選組件:
  - Elasticsearch (可用 PostgreSQL 全文搜尋替代)
  - Kafka (可用 Redis 替代)
```

### 標準部署（小型生產）

```yaml
必需組件:
  - PostgreSQL (主從)
  - Redis Cluster (3節點)
  - Elasticsearch (3節點)
  - Kafka (3節點)
  - Docker + Kubernetes (3 master + 5 worker)
  - Prometheus + Grafana
  - Nginx/Kong (API Gateway)
```

### 企業級部署（大型生產）

```yaml
完整組件:
  - PostgreSQL HA Cluster (Patroni + HAProxy)
  - Redis Cluster (6+ 節點)
  - Elasticsearch Cluster (9+ 節點)
  - Kafka Cluster (6+ broker)
  - Kubernetes HA (多 master)
  - Flink Cluster (JobManager + TaskManager)
  - ClickHouse Cluster (分片副本)
  - 完整監控棧 (Prometheus + Grafana + Loki + Jaeger)
  - 服務網格 (Istio)
  - API 閘道 (Kong Enterprise)
```

---

## 🔄 數據流與中間件

### 採集階段

```
外部網站 → Scrapy → Kafka → Flink → MongoDB/Elasticsearch
                            ↓
                          Redis (去重)
```

### 處理階段

```
資料源 → Airflow → Celery → 處理任務 → PostgreSQL
                   ↓
                 Redis (狀態)
```

### 監控階段

```
各模組 → Prometheus → Grafana (視覺化)
        → Alertmanager (告警)
        → InfluxDB (長期儲存)
```

### 日誌階段

```
應用日誌 → Filebeat → Logstash → Elasticsearch → Kibana
```

---

## 📚 學習資源

### 官方文檔

| 中間件 | 文檔連結 |
|--------|---------|
| Kubernetes | https://kubernetes.io/docs/ |
| Apache Kafka | https://kafka.apache.org/documentation/ |
| Apache Flink | https://flink.apache.org/docs/ |
| Redis | https://redis.io/docs/ |
| PostgreSQL | https://www.postgresql.org/docs/ |

### 最佳實踐

| 主題 | 推薦資源 |
|------|---------|
| 微服務架構 | Martin Fowler's Microservices |
| 分布式系統 | Designing Data-Intensive Applications |
| Kubernetes | Kubernetes in Action |
| 流處理 | Streaming Systems (O'Reilly) |

---

## 🎓 技能要求

### 必備技能

- ✅ Linux 系統管理
- ✅ Docker 容器化
- ✅ Python/Java 程式設計
- ✅ SQL/NoSQL 資料庫
- ✅ 網路基礎知識

### 進階技能

- ⭐ Kubernetes 編排
- ⭐ 分布式系統設計
- ⭐ 流式資料處理
- ⭐ 效能調優
- ⭐ 安全與合規

---

**最後更新**: 2025-10-31  
**維護者**: 鏡界平台團隊

