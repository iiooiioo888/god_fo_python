# ç¬¬12ç« ï¼šæ•¸æ“šè³ªé‡ç®¡ç†ä¸­å¿ƒ

## 12.2 è©³ç´°åŠŸèƒ½æ¸…å–®

**[â† è¿”å›ç¬¬12ç« é¦–é ](ch12-index.md)**

---

## ğŸ“‹ åŠŸèƒ½åˆ†é¡ç¸½è¦½

```
æ•¸æ“šè³ªé‡ç®¡ç†ä¸­å¿ƒåŠŸèƒ½æ¨¹
â”œâ”€â”€ 1. è³ªé‡ç›£æ§ (Quality Monitoring)
â”‚   â”œâ”€â”€ 1.1 å¯¦æ™‚ç›£æ§
â”‚   â”œâ”€â”€ 1.2 æŒ‡æ¨™æ¡é›†
â”‚   â”œâ”€â”€ 1.3 å‘Šè­¦ç®¡ç†
â”‚   â””â”€â”€ 1.4 çœ‹æ¿å±•ç¤º
â”œâ”€â”€ 2. æ•¸æ“šæ¸…æ´— (Data Cleaning)
â”‚   â”œâ”€â”€ 2.1 å»é‡è™•ç†
â”‚   â”œâ”€â”€ 2.2 æ ¼å¼æ¨™æº–åŒ–
â”‚   â”œâ”€â”€ 2.3 ç¼ºå¤±å€¼è™•ç†
â”‚   â”œâ”€â”€ 2.4 ç•°å¸¸å€¼è™•ç†
â”‚   â””â”€â”€ 2.5 æ•¸æ“šè½‰æ›
â”œâ”€â”€ 3. è³ªé‡æ ¡é©— (Quality Validation)
â”‚   â”œâ”€â”€ 3.1 è¦å‰‡å¼•æ“
â”‚   â”œâ”€â”€ 3.2 æ¥­å‹™è¦å‰‡é©—è­‰
â”‚   â”œâ”€â”€ 3.3 é¡å‹æª¢æŸ¥
â”‚   â””â”€â”€ 3.4 ç´„æŸé©—è­‰
â”œâ”€â”€ 4. ç•°å¸¸æª¢æ¸¬ (Anomaly Detection)
â”‚   â”œâ”€â”€ 4.1 çµ±è¨ˆæ–¹æ³•
â”‚   â”œâ”€â”€ 4.2 æ©Ÿå™¨å­¸ç¿’æ–¹æ³•
â”‚   â”œâ”€â”€ 4.3 å¯¦æ™‚æª¢æ¸¬
â”‚   â””â”€â”€ 4.4 æ‰¹é‡åˆ†æ
â”œâ”€â”€ 5. è³ªé‡è©•åˆ† (Quality Scoring)
â”‚   â”œâ”€â”€ 5.1 äº”ç¶­è©•åˆ†
â”‚   â”œâ”€â”€ 5.2 è¶¨å‹¢åˆ†æ
â”‚   â”œâ”€â”€ 5.3 å°æ¯”åˆ†æ
â”‚   â””â”€â”€ 5.4 è©•åˆ†æ¨¡å‹ç®¡ç†
â”œâ”€â”€ 6. æ•¸æ“šè¡€ç·£ (Data Lineage)
â”‚   â”œâ”€â”€ 6.1 è¡€ç·£è¿½è¹¤
â”‚   â”œâ”€â”€ 6.2 å½±éŸ¿åˆ†æ
â”‚   â”œâ”€â”€ 6.3 è·¯å¾‘æŸ¥è©¢
â”‚   â””â”€â”€ 6.4 è¡€ç·£å¯è¦–åŒ–
â”œâ”€â”€ 7. è³ªé‡å ±å‘Š (Quality Reporting)
â”‚   â”œâ”€â”€ 7.1 å®šæœŸå ±å‘Š
â”‚   â”œâ”€â”€ 7.2 å•é¡Œå ±å‘Š
â”‚   â”œâ”€â”€ 7.3 è¶¨å‹¢å ±å‘Š
â”‚   â””â”€â”€ 7.4 è‡ªå®šç¾©å ±å‘Š
â”œâ”€â”€ 8. ä¿®å¾©ç®¡ç† (Fix Management)
â”‚   â”œâ”€â”€ 8.1 è‡ªå‹•ä¿®å¾©
â”‚   â”œâ”€â”€ 8.2 ä¿®å¾©å»ºè­°
â”‚   â”œâ”€â”€ 8.3 äººå·¥å¯©æ ¸
â”‚   â””â”€â”€ 8.4 ä¿®å¾©è¿½è¹¤
â””â”€â”€ 9. é…ç½®ç®¡ç† (Configuration Management)
    â”œâ”€â”€ 9.1 è¦å‰‡é…ç½®
    â”œâ”€â”€ 9.2 é–¾å€¼é…ç½®
    â”œâ”€â”€ 9.3 ç­–ç•¥é…ç½®
    â””â”€â”€ 9.4 æ¨¡æ¿ç®¡ç†
```

---

## 1ï¸âƒ£ è³ªé‡ç›£æ§åŠŸèƒ½

### 1.1 å¯¦æ™‚ç›£æ§

#### åŠŸèƒ½æè¿°
å¯¦æ™‚ç›£æ§æ•¸æ“šæµå…¥çš„è³ªé‡ç‹€æ…‹ï¼ŒåŠæ™‚ç™¼ç¾å•é¡Œã€‚

#### æ ¸å¿ƒèƒ½åŠ›

| åŠŸèƒ½é» | èªªæ˜ | å„ªå…ˆç´š | è¤‡é›œåº¦ |
|-------|------|-------|--------|
| **æµå¼è³ªé‡æª¢æŸ¥** | å°æµå…¥æ•¸æ“šé€²è¡Œå¯¦æ™‚è³ªé‡æª¢æŸ¥ | P0 | é«˜ |
| **å¯¦æ™‚æŒ‡æ¨™è¨ˆç®—** | è¨ˆç®—å¯¦æ™‚è³ªé‡æŒ‡æ¨™ï¼ˆQPSã€éŒ¯èª¤ç‡ç­‰ï¼‰ | P0 | ä¸­ |
| **è³ªé‡è¶¨å‹¢ç›£æ§** | ç›£æ§è³ªé‡æŒ‡æ¨™çš„è®ŠåŒ–è¶¨å‹¢ | P1 | ä¸­ |
| **å¤šç¶­åº¦èšåˆ** | æŒ‰æ™‚é–“/ä¾†æº/é¡å‹ç­‰ç¶­åº¦èšåˆ | P1 | é«˜ |
| **å¯¦æ™‚çœ‹æ¿** | å±•ç¤ºå¯¦æ™‚è³ªé‡ç‹€æ…‹ | P0 | ä½ |

#### æŠ€è¡“å¯¦ç¾

```
å¯¦æ™‚ç›£æ§æ¶æ§‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•¸æ“šæµå…¥     â”‚ â†’ Kafka
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flink CEP    â”‚ â†’ å¯¦æ™‚æª¢æ¸¬
â”‚ è³ªé‡æª¢æŸ¥     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InfluxDB     â”‚ â†’ æ™‚åºå­˜å„²
â”‚ æŒ‡æ¨™å­˜å„²     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Grafana      â”‚ â†’ å¯¦æ™‚å±•ç¤º
â”‚ çœ‹æ¿å±•ç¤º     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æŒ‡æ¨™æ¡é›†

#### è³ªé‡æŒ‡æ¨™é«”ç³»

**å®Œæ•´æ€§æŒ‡æ¨™**
- **ç©ºå€¼ç‡ï¼ˆNull Rateï¼‰**: `(NULLæ•¸é‡ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`
- **ç¼ºå¤±ç‡ï¼ˆMissing Rateï¼‰**: `(ç¼ºå¤±å­—æ®µæ•¸ / æ‡‰æœ‰å­—æ®µæ•¸) Ã— 100%`
- **å¿…å¡«å®Œæ•´ç‡**: `(å¿…å¡«å­—æ®µå®Œæ•´è¨˜éŒ„ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`

**æº–ç¢ºæ€§æŒ‡æ¨™**
- **æ ¼å¼æ­£ç¢ºç‡**: `(æ ¼å¼æ­£ç¢ºæ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`
- **ç¯„åœæœ‰æ•ˆç‡**: `(ç¯„åœå…§è¨˜éŒ„æ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`
- **é¡å‹åŒ¹é…ç‡**: `(é¡å‹æ­£ç¢ºæ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`

**ä¸€è‡´æ€§æŒ‡æ¨™**
- **è·¨è¡¨ä¸€è‡´ç‡**: `(ä¸€è‡´è¨˜éŒ„æ•¸ / é—œè¯è¨˜éŒ„æ•¸) Ã— 100%`
- **é‚è¼¯ä¸€è‡´ç‡**: `(é‚è¼¯æ­£ç¢ºæ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`
- **åƒç…§å®Œæ•´æ€§**: `(å¤–éµæœ‰æ•ˆæ•¸ / å¤–éµç¸½æ•¸) Ã— 100%`

**æ™‚æ•ˆæ€§æŒ‡æ¨™**
- **æ•¸æ“šæ–°é®®åº¦**: `ç•¶å‰æ™‚é–“ - æ•¸æ“šæ›´æ–°æ™‚é–“`
- **æ›´æ–°å»¶é²**: `é æœŸæ›´æ–°æ™‚é–“ - å¯¦éš›æ›´æ–°æ™‚é–“`
- **éæœŸæ•¸æ“šç‡**: `(éæœŸè¨˜éŒ„æ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`

**å”¯ä¸€æ€§æŒ‡æ¨™**
- **é‡è¤‡ç‡**: `(é‡è¤‡è¨˜éŒ„æ•¸ / ç¸½è¨˜éŒ„æ•¸) Ã— 100%`
- **ä¸»éµå”¯ä¸€ç‡**: `(å”¯ä¸€ä¸»éµæ•¸ / ç¸½ä¸»éµæ•¸) Ã— 100%`

### 1.3 å‘Šè­¦ç®¡ç†

#### å‘Šè­¦è¦å‰‡

| å‘Šè­¦é¡å‹ | è§¸ç™¼æ¢ä»¶ | ç´šåˆ¥ | é€šçŸ¥æ–¹å¼ |
|---------|---------|------|---------|
| **è³ªé‡ä¸‹é™** | è³ªé‡åˆ†æ•¸ < 80åˆ† | åš´é‡ | Email + Slack + é‡˜é‡˜ |
| **ç•°å¸¸æ¿€å¢** | ç•°å¸¸ç‡ > 10% | åš´é‡ | Email + Slack |
| **æ•¸æ“šå»¶é²** | å»¶é² > 1å°æ™‚ | è­¦å‘Š | Slack |
| **é‡è¤‡ç‡é«˜** | é‡è¤‡ç‡ > 5% | è­¦å‘Š | Email |
| **ç©ºå€¼ç•°å¸¸** | ç©ºå€¼ç‡ > 20% | è­¦å‘Š | Email |

#### å‘Šè­¦æµç¨‹

```
æª¢æ¸¬åˆ°å•é¡Œ
    â†“
è©•ä¼°åš´é‡ç¨‹åº¦
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åš´é‡   â”‚ è­¦å‘Š   â”‚ æç¤º   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ç«‹å³é€šçŸ¥â”‚ å»¶é²5åˆ†â”‚ æ—¥å ±   â”‚
â”‚æ‰€æœ‰äºº  â”‚ é€šçŸ¥çµ„é•·â”‚ åŒ¯ç¸½   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¨˜éŒ„å‘Šè­¦æ­·å²
    â†“
è¿½è¹¤è™•ç†ç‹€æ…‹
```

### 1.4 çœ‹æ¿å±•ç¤º

#### çœ‹æ¿å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•¸æ“šè³ªé‡ç®¡ç†çœ‹æ¿                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚æ•´é«”è©•åˆ† â”‚ â”‚ä»Šæ—¥è™•ç† â”‚ â”‚ç•°å¸¸æ•¸é‡ â”‚ â”‚æ¸…æ´—ç‡   â”‚  â”‚
â”‚  â”‚  95.2   â”‚ â”‚ 1.2M    â”‚ â”‚  125    â”‚ â”‚  98%    â”‚  â”‚
â”‚  â”‚  â†‘ +2.3 â”‚ â”‚  â†‘ +10% â”‚ â”‚  â†“ -15  â”‚ â”‚  â†‘ +2%  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  äº”ç¶­è³ªé‡é›·é”åœ–          â”‚  è³ªé‡è¶¨å‹¢åœ–              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     å®Œæ•´æ€§        â”‚  â”‚  â”‚ 100â”¤             â”‚   â”‚
â”‚  â”‚    /     \        â”‚  â”‚  â”‚  90â”¤ â”€â”€â”€â•®        â”‚   â”‚
â”‚  â”‚  æº–     ä¸€        â”‚  â”‚  â”‚  80â”¤     â•°â”€â”€â”€    â”‚   â”‚
â”‚  â”‚   ç¢º   è‡´         â”‚  â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚    \   /          â”‚  â”‚  â”‚     8:00  12:00  â”‚   â”‚
â”‚  â”‚   æ™‚æ•ˆ/å”¯ä¸€       â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top å•é¡Œåˆ—è¡¨            â”‚  æ•¸æ“šæºè³ªé‡åˆ†å¸ƒ          â”‚
â”‚  1. URLæ ¼å¼éŒ¯èª¤ (1.5è¬)â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  2. åƒ¹æ ¼ç•°å¸¸ (8åƒ)      â”‚  â”‚ Ch8: 96åˆ†       â”‚   â”‚
â”‚  3. åœ–ç‰‡ç¼ºå¤± (5åƒ)      â”‚  â”‚ Ch1: 94åˆ†       â”‚   â”‚
â”‚                          â”‚  â”‚ API: 91åˆ†       â”‚   â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2ï¸âƒ£ æ•¸æ“šæ¸…æ´—åŠŸèƒ½

### 2.1 å»é‡è™•ç†

#### å»é‡ç­–ç•¥

| ç­–ç•¥ | èªªæ˜ | é©ç”¨å ´æ™¯ | æº–ç¢ºç‡ |
|-----|------|---------|--------|
| **å®Œå…¨åŒ¹é…** | æ‰€æœ‰å­—æ®µå®Œå…¨ç›¸åŒ | çµæ§‹åŒ–æ•¸æ“š | 100% |
| **ä¸»éµå»é‡** | åŸºæ–¼ä¸»éµ/å”¯ä¸€éµ | æœ‰ä¸»éµçš„æ•¸æ“š | 100% |
| **æ¨¡ç³ŠåŒ¹é…** | ç›¸ä¼¼åº¦ > é–¾å€¼ | æ–‡æœ¬æ•¸æ“š | 85-95% |
| **æŒ‡ç´‹å»é‡** | SimHash/MinHash | å¤§è¦æ¨¡æ•¸æ“š | 90-98% |
| **èªç¾©å»é‡** | åŸºæ–¼å‘é‡ç›¸ä¼¼åº¦ | æ–‡æœ¬å…§å®¹ | 80-90% |

#### å»é‡é…ç½®ç¤ºä¾‹

```python
deduplication_config = {
    # ç²¾ç¢ºåŒ¹é…å»é‡
    "exact_match": {
        "enabled": True,
        "key_columns": ["url", "publish_date"],
        "keep": "first"  # first, last, none
    },
    
    # æ¨¡ç³ŠåŒ¹é…å»é‡
    "fuzzy_match": {
        "enabled": True,
        "columns": ["title", "content"],
        "similarity_threshold": 0.85,
        "method": "levenshtein"  # levenshtein, jaccard, cosine
    },
    
    # æŒ‡ç´‹å»é‡
    "fingerprint": {
        "enabled": True,
        "columns": ["content"],
        "method": "simhash",
        "hamming_distance": 3
    }
}
```

### 2.2 æ ¼å¼æ¨™æº–åŒ–

#### æ¨™æº–åŒ–è¦å‰‡

**æ—¥æœŸæ™‚é–“æ¨™æº–åŒ–**
```
è¼¸å…¥æ ¼å¼å¤šæ¨£ï¼š
- "2025-10-31"
- "2025/10/31"
- "31-Oct-2025"
- "1698710400" (Unix timestamp)

è¼¸å‡ºçµ±ä¸€æ ¼å¼ï¼š
- ISO 8601: "2025-10-31T00:00:00Z"
```

**URL æ¨™æº–åŒ–**
```
æ¸…ç†æ­¥é©Ÿï¼š
1. ç§»é™¤è¿½è¹¤åƒæ•¸: ?utm_source=xxx
2. çµ±ä¸€å”è­°: https://
3. ç§»é™¤æœ«å°¾æ–œç·š
4. å°å¯«åŸŸå
5. è§£ç¢¼ URL ç·¨ç¢¼

ç¤ºä¾‹ï¼š
è¼¸å…¥: HTTP://Example.COM/path/?utm_source=fb&id=1
è¼¸å‡º: https://example.com/path?id=1
```

**åƒ¹æ ¼æ¨™æº–åŒ–**
```
æ¸…ç†æ­¥é©Ÿï¼š
1. ç§»é™¤è²¨å¹£ç¬¦è™Ÿ: $, Â¥, â‚¬
2. ç§»é™¤åƒåˆ†ä½ç¬¦è™Ÿ: ,
3. çµ±ä¸€å°æ•¸é»: . 
4. è½‰æ›ç‚ºæ•¸å€¼é¡å‹

ç¤ºä¾‹ï¼š
è¼¸å…¥: "$1,234.56", "Â¥1,234", "1234.56å…ƒ"
è¼¸å‡º: 1234.56 (float)
```

### 2.3 ç¼ºå¤±å€¼è™•ç†

#### è™•ç†ç­–ç•¥

| ç­–ç•¥ | èªªæ˜ | é©ç”¨å ´æ™¯ | ç¤ºä¾‹ |
|-----|------|---------|------|
| **åˆªé™¤** | åˆªé™¤å«ç¼ºå¤±å€¼çš„è¨˜éŒ„ | ç¼ºå¤±ç‡ < 5% | - |
| **å¡«å……å›ºå®šå€¼** | ç”¨å¸¸é‡å¡«å…… | æœ‰é»˜èªå€¼çš„å­—æ®µ | 0, "N/A", false |
| **å‡å€¼å¡«å……** | ç”¨å¹³å‡å€¼å¡«å…… | æ•¸å€¼å‹é€£çºŒè®Šé‡ | age â†’ å¹³å‡å¹´é½¡ |
| **ä¸­ä½æ•¸å¡«å……** | ç”¨ä¸­ä½æ•¸å¡«å…… | æœ‰ç•°å¸¸å€¼çš„æ•¸å€¼ | salary â†’ ä¸­ä½æ•¸ |
| **çœ¾æ•¸å¡«å……** | ç”¨æœ€å¸¸è¦‹å€¼å¡«å…… | åˆ†é¡è®Šé‡ | gender â†’ æœ€å¸¸è¦‹æ€§åˆ¥ |
| **å‰å¾Œå‘å¡«å……** | ç”¨å‰/å¾Œå€¼å¡«å…… | æ™‚åºæ•¸æ“š | è‚¡åƒ¹æ•¸æ“š |
| **æ’å€¼å¡«å……** | ç·šæ€§/å¤šé …å¼æ’å€¼ | æ™‚åºæ•¸æ“š | æº«åº¦æ•¸æ“š |
| **æ¨¡å‹é æ¸¬** | ç”¨MLæ¨¡å‹é æ¸¬ | è¤‡é›œé—œè¯æ•¸æ“š | åŸºæ–¼å…¶ä»–ç‰¹å¾µé æ¸¬ |

#### ç¼ºå¤±å€¼è™•ç†é…ç½®

```python
missing_value_config = {
    "strategies": {
        # æ•¸å€¼å‹
        "age": {
            "method": "median",
            "fallback": 0
        },
        "price": {
            "method": "mean",
            "outlier_removal": True
        },
        
        # åˆ†é¡å‹
        "category": {
            "method": "mode",
            "fallback": "unknown"
        },
        "status": {
            "method": "constant",
            "value": "pending"
        },
        
        # æ™‚åºå‹
        "temperature": {
            "method": "interpolate",
            "order": "linear"
        },
        
        # è¤‡é›œé æ¸¬
        "income": {
            "method": "model_predict",
            "model": "random_forest",
            "features": ["age", "education", "experience"]
        }
    }
}
```

### 2.4 ç•°å¸¸å€¼è™•ç†

#### ç•°å¸¸å€¼æª¢æ¸¬æ–¹æ³•

**çµ±è¨ˆæ–¹æ³•**
```python
# Z-Score æ–¹æ³•
z_score = (x - mean) / std
ç•°å¸¸: |z_score| > 3

# IQR æ–¹æ³•
Q1 = 25th percentile
Q3 = 75th percentile
IQR = Q3 - Q1
ç•°å¸¸: x < Q1 - 1.5Ã—IQR æˆ– x > Q3 + 1.5Ã—IQR

# MAD æ–¹æ³• (Median Absolute Deviation)
MAD = median(|x - median(x)|)
ç•°å¸¸: |x - median(x)| > k Ã— MAD (k=3)
```

#### ç•°å¸¸å€¼è™•ç†ç­–ç•¥

| ç­–ç•¥ | èªªæ˜ | é©ç”¨å ´æ™¯ |
|-----|------|---------|
| **åˆªé™¤** | ç›´æ¥åˆªé™¤ç•°å¸¸è¨˜éŒ„ | ç•°å¸¸ç‡ < 1% |
| **æˆªæ–·** | é™åˆ¶åœ¨åˆç†ç¯„åœå…§ | åƒ¹æ ¼ã€å¹´é½¡ç­‰ |
| **æ›¿æ›** | ç”¨å‡å€¼/ä¸­ä½æ•¸æ›¿æ› | æ•¸å€¼å‹æ•¸æ“š |
| **æ¨™è¨˜** | æ¨™è¨˜ä½†ä¿ç•™ | éœ€äººå·¥å¯©æ ¸ |
| **åˆ†ç®±** | å°‡ç•°å¸¸å€¼æ­¸å…¥é‚Šç•Œç®± | ç‰¹å¾µå·¥ç¨‹ |

### 2.5 æ•¸æ“šè½‰æ›

#### è½‰æ›é¡å‹

**é¡å‹è½‰æ›**
```python
transformations = {
    # å­—ç¬¦ä¸² â†’ æ•¸å€¼
    "price": {
        "from": "string",
        "to": "float",
        "preprocessing": ["remove_currency", "remove_comma"]
    },
    
    # å­—ç¬¦ä¸² â†’ æ—¥æœŸ
    "date": {
        "from": "string",
        "to": "datetime",
        "format": "auto_detect"
    },
    
    # æšèˆ‰ â†’ æ•¸å€¼
    "priority": {
        "from": "string",
        "to": "int",
        "mapping": {"low": 1, "medium": 2, "high": 3}
    }
}
```

**ç·¨ç¢¼è½‰æ›**
```python
encoding_config = {
    # One-Hot ç·¨ç¢¼
    "category": {
        "method": "onehot",
        "handle_unknown": "ignore"
    },
    
    # Label ç·¨ç¢¼
    "status": {
        "method": "label",
        "ordered": True
    },
    
    # Target ç·¨ç¢¼
    "location": {
        "method": "target",
        "target_column": "sales"
    }
}
```

---

## 3ï¸âƒ£ è³ªé‡æ ¡é©—åŠŸèƒ½

### 3.1 è¦å‰‡å¼•æ“

#### è¦å‰‡é¡å‹

**å­—æ®µè¦å‰‡**
```yaml
field_rules:
  - name: "age_range"
    field: "age"
    type: "range"
    min: 0
    max: 150
    severity: "error"
    
  - name: "email_format"
    field: "email"
    type: "regex"
    pattern: "^[\\w\\.-]+@[\\w\\.-]+\\.\\w+$"
    severity: "error"
    
  - name: "price_positive"
    field: "price"
    type: "expression"
    expression: "price > 0"
    severity: "error"
    
  - name: "phone_length"
    field: "phone"
    type: "length"
    min: 10
    max: 15
    severity: "warning"
```

**è·¨å­—æ®µè¦å‰‡**
```yaml
cross_field_rules:
  - name: "end_after_start"
    type: "comparison"
    expression: "end_date > start_date"
    severity: "error"
    
  - name: "discount_valid"
    type: "expression"
    expression: "discount_price <= original_price"
    severity: "error"
    
  - name: "total_sum_match"
    type: "aggregation"
    expression: "SUM(item_price) == total_price"
    tolerance: 0.01
    severity: "warning"
```

**æ¥­å‹™è¦å‰‡**
```yaml
business_rules:
  - name: "valid_order_status"
    type: "enum"
    field: "status"
    allowed_values: ["pending", "processing", "completed", "cancelled"]
    severity: "error"
    
  - name: "product_category_match"
    type: "lookup"
    field: "category_id"
    reference_table: "categories"
    reference_field: "id"
    severity: "error"
    
  - name: "inventory_check"
    type: "custom"
    function: "check_inventory_available"
    params: ["product_id", "quantity"]
    severity: "warning"
```

### 3.2 æ¥­å‹™è¦å‰‡é©—è­‰

#### è¦å‰‡ç¤ºä¾‹åº«

**é›»å•†å ´æ™¯**
```python
ecommerce_rules = [
    # åƒ¹æ ¼é‚è¼¯
    {
        "name": "discount_logic",
        "rule": "0 <= discount_percent <= 100",
        "message": "æŠ˜æ‰£ç™¾åˆ†æ¯”å¿…é ˆåœ¨ 0-100 ä¹‹é–“"
    },
    {
        "name": "final_price",
        "rule": "final_price == original_price * (1 - discount_percent/100)",
        "tolerance": 0.01,
        "message": "æœ€çµ‚åƒ¹æ ¼è¨ˆç®—ä¸æ­£ç¢º"
    },
    
    # åº«å­˜é‚è¼¯
    {
        "name": "stock_available",
        "rule": "order_quantity <= stock_quantity",
        "message": "è¨‚å–®æ•¸é‡è¶…éåº«å­˜"
    },
    
    # æ™‚é–“é‚è¼¯
    {
        "name": "delivery_time",
        "rule": "delivery_date >= order_date + 1day",
        "message": "é…é€æ—¥æœŸä¸èƒ½æ—©æ–¼è¨‚å–®æ—¥æœŸ"
    }
]
```

**å…§å®¹å¹³å°å ´æ™¯**
```python
content_platform_rules = [
    # å…§å®¹è³ªé‡
    {
        "name": "title_length",
        "rule": "10 <= LEN(title) <= 100",
        "message": "æ¨™é¡Œé•·åº¦æ‡‰åœ¨ 10-100 å­—ç¬¦ä¹‹é–“"
    },
    {
        "name": "content_length",
        "rule": "LEN(content) >= 100",
        "message": "å…§å®¹é•·åº¦è‡³å°‘ 100 å­—ç¬¦"
    },
    
    # ç™¼å¸ƒé‚è¼¯
    {
        "name": "publish_status",
        "rule": "IF status=='published' THEN publish_date IS NOT NULL",
        "message": "å·²ç™¼å¸ƒå…§å®¹å¿…é ˆæœ‰ç™¼å¸ƒæ—¥æœŸ"
    },
    
    # åˆ†é¡é‚è¼¯
    {
        "name": "category_valid",
        "rule": "category_id IN (SELECT id FROM categories WHERE active=true)",
        "message": "åˆ†é¡IDç„¡æ•ˆæˆ–å·²åœç”¨"
    }
]
```

### 3.3 é¡å‹æª¢æŸ¥

#### é¡å‹é©—è­‰è¦å‰‡

```python
type_validation = {
    "columns": {
        "id": {
            "type": "integer",
            "nullable": False,
            "unique": True
        },
        "email": {
            "type": "string",
            "pattern": r"^[\w\.-]+@[\w\.-]+\.\w+$",
            "nullable": False
        },
        "age": {
            "type": "integer",
            "min": 0,
            "max": 150,
            "nullable": True
        },
        "price": {
            "type": "float",
            "min": 0,
            "precision": 2,
            "nullable": False
        },
        "created_at": {
            "type": "datetime",
            "format": "ISO8601",
            "nullable": False
        },
        "tags": {
            "type": "array",
            "item_type": "string",
            "min_items": 0,
            "max_items": 10
        },
        "metadata": {
            "type": "json",
            "schema": "metadata_schema.json"
        }
    }
}
```

### 3.4 ç´„æŸé©—è­‰

#### ç´„æŸé¡å‹

**å¯¦é«”å®Œæ•´æ€§ç´„æŸ**
```sql
-- ä¸»éµç´„æŸ
PRIMARY KEY (id)

-- å”¯ä¸€ç´„æŸ
UNIQUE (email)
UNIQUE (username)

-- éç©ºç´„æŸ
NOT NULL (email, username, created_at)
```

**åƒç…§å®Œæ•´æ€§ç´„æŸ**
```sql
-- å¤–éµç´„æŸ
FOREIGN KEY (user_id) REFERENCES users(id)
  ON DELETE CASCADE
  ON UPDATE CASCADE

-- å¤šå°å¤šé—œè¯
FOREIGN KEY (order_id) REFERENCES orders(id)
FOREIGN KEY (product_id) REFERENCES products(id)
```

**åŸŸå®Œæ•´æ€§ç´„æŸ**
```sql
-- æª¢æŸ¥ç´„æŸ
CHECK (age >= 0 AND age <= 150)
CHECK (price > 0)
CHECK (status IN ('active', 'inactive', 'deleted'))
CHECK (email LIKE '%@%.%')
```

---

## 4ï¸âƒ£ ç•°å¸¸æª¢æ¸¬åŠŸèƒ½

### 4.1 çµ±è¨ˆæ–¹æ³•

#### æ–¹æ³•å°æ¯”

| æ–¹æ³• | åŸç† | å„ªé» | ç¼ºé» | é©ç”¨å ´æ™¯ |
|------|------|------|------|---------|
| **Z-Score** | æ¨™æº–å·®åé›¢ | ç°¡å–®å¿«é€Ÿ | å‡è¨­æ­£æ…‹åˆ†ä½ˆ | è¿‘ä¼¼æ­£æ…‹åˆ†ä½ˆæ•¸æ“š |
| **IQR** | å››åˆ†ä½æ•¸ | é­¯æ£’æ€§å¼· | å¯èƒ½éæ–¼ä¿å®ˆ | æœ‰ç•°å¸¸å€¼çš„æ•¸æ“š |
| **MAD** | ä¸­ä½æ•¸çµ•å°åå·® | é«˜é­¯æ£’æ€§ | è¨ˆç®—ç¨è¤‡é›œ | åš´é‡åæ…‹æ•¸æ“š |
| **Grubbs Test** | çµ±è¨ˆæª¢é©— | æœ‰ç†è«–åŸºç¤ | åªèƒ½æª¢æ¸¬å–®å€‹ç•°å¸¸ | å°æ¨£æœ¬æ•¸æ“š |

#### å¯¦ç¾ç¤ºä¾‹

```python
# Z-Score æª¢æ¸¬
def detect_outliers_zscore(data, threshold=3):
    z_scores = (data - data.mean()) / data.std()
    return abs(z_scores) > threshold

# IQR æª¢æ¸¬
def detect_outliers_iqr(data, k=1.5):
    Q1 = data.quantile(0.25)
    Q3 = data.quantile(0.75)
    IQR = Q3 - Q1
    lower = Q1 - k * IQR
    upper = Q3 + k * IQR
    return (data < lower) | (data > upper)

# MAD æª¢æ¸¬
def detect_outliers_mad(data, threshold=3.5):
    median = data.median()
    mad = (data - median).abs().median()
    modified_z = 0.6745 * (data - median) / mad
    return abs(modified_z) > threshold
```

### 4.2 æ©Ÿå™¨å­¸ç¿’æ–¹æ³•

#### ç®—æ³•å°æ¯”

| ç®—æ³• | é¡å‹ | æ™‚é–“è¤‡é›œåº¦ | å„ªé» | ç¼ºé» |
|------|------|-----------|------|------|
| **Isolation Forest** | ç„¡ç›£ç£ | O(n log n) | é«˜æ•ˆã€å¯æ“´å±• | åƒæ•¸æ•æ„Ÿ |
| **Local Outlier Factor** | ç„¡ç›£ç£ | O(nÂ²) | å±€éƒ¨ç•°å¸¸æª¢æ¸¬ | è¨ˆç®—æ…¢ |
| **One-Class SVM** | ç„¡ç›£ç£ | O(nÂ²) | ç†è«–å®Œå–„ | å¤§æ•¸æ“šæ…¢ |
| **DBSCAN** | èšé¡ | O(n log n) | å¯†åº¦æª¢æ¸¬ | åƒæ•¸é›£èª¿ |
| **Autoencoder** | æ·±åº¦å­¸ç¿’ | O(n) | è¤‡é›œæ¨¡å¼ | éœ€å¤§é‡æ•¸æ“š |

#### é…ç½®ç¤ºä¾‹

```python
anomaly_detection_config = {
    "methods": [
        {
            "name": "isolation_forest",
            "enabled": True,
            "params": {
                "contamination": 0.1,  # é æœŸç•°å¸¸æ¯”ä¾‹
                "n_estimators": 100,
                "max_samples": "auto"
            },
            "weight": 0.4
        },
        {
            "name": "lof",
            "enabled": True,
            "params": {
                "n_neighbors": 20,
                "contamination": 0.1
            },
            "weight": 0.3
        },
        {
            "name": "statistical",
            "enabled": True,
            "params": {
                "method": "mad",
                "threshold": 3.5
            },
            "weight": 0.3
        }
    ],
    "ensemble": {
        "method": "weighted_average",
        "threshold": 0.7  # ç¶œåˆå¾—åˆ† > 0.7 åˆ¤å®šç‚ºç•°å¸¸
    }
}
```

### 4.3 å¯¦æ™‚æª¢æ¸¬

#### å¯¦æ™‚æª¢æ¸¬æ¶æ§‹

```
æ•¸æ“šæµ â†’ Kafka
    â†“
Flink å¯¦æ™‚è™•ç†
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ»‘å‹•çª—å£çµ±è¨ˆ                    â”‚
â”‚ â€¢ 5åˆ†é˜çª—å£                     â”‚
â”‚ â€¢ è¨ˆç®—å‡å€¼ã€æ¨™æº–å·®              â”‚
â”‚ â€¢ èˆ‡æ­·å²åŸºç·šå°æ¯”                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯¦æ™‚ç•°å¸¸åˆ¤å®š                    â”‚
â”‚ â€¢ Z-Score > 3: ç•°å¸¸             â”‚
â”‚ â€¢ é€£çºŒ3å€‹çª—å£ç•°å¸¸: åš´é‡ç•°å¸¸     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘Šè­¦è§¸ç™¼                        â”‚
â”‚ â€¢ é«˜å„ªå…ˆç´š: ç«‹å³é€šçŸ¥            â”‚
â”‚ â€¢ ä½å„ªå…ˆç´š: æ‰¹é‡é€šçŸ¥            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 æ‰¹é‡åˆ†æ

#### é›¢ç·šåˆ†ææµç¨‹

```python
# æ¯æ—¥æ‰¹é‡ç•°å¸¸åˆ†æ
def daily_anomaly_analysis():
    # 1. åŠ è¼‰æ•¸æ“š
    data = load_daily_data()
    
    # 2. ç‰¹å¾µå·¥ç¨‹
    features = extract_features(data)
    
    # 3. å¤šæ¨¡å‹æª¢æ¸¬
    results = {
        'isolation_forest': detect_if(features),
        'lof': detect_lof(features),
        'autoencoder': detect_ae(features)
    }
    
    # 4. æ¨¡å‹èåˆ
    anomaly_scores = ensemble_models(results)
    
    # 5. çµæœåˆ†æ
    anomalies = anomaly_scores > threshold
    
    # 6. æ ¹å› åˆ†æ
    root_causes = analyze_root_cause(data[anomalies])
    
    # 7. ç”Ÿæˆå ±å‘Š
    generate_report(anomalies, root_causes)
    
    return report
```

---

## 5ï¸âƒ£ è³ªé‡è©•åˆ†åŠŸèƒ½

### 5.1 äº”ç¶­è©•åˆ†

#### è©•åˆ†å…¬å¼

```python
def calculate_quality_score(data, weights=None):
    """
    è¨ˆç®—æ•¸æ“šè³ªé‡åˆ†æ•¸
    
    Args:
        data: æ•¸æ“šé›†
        weights: å„ç¶­åº¦æ¬Šé‡ (é»˜èª: [0.25, 0.30, 0.20, 0.15, 0.10])
    
    Returns:
        ç¸½åˆ† (0-100)
    """
    if weights is None:
        weights = {
            'completeness': 0.25,
            'accuracy': 0.30,
            'consistency': 0.20,
            'timeliness': 0.15,
            'uniqueness': 0.10
        }
    
    scores = {}
    
    # 1. å®Œæ•´æ€§å¾—åˆ†
    scores['completeness'] = calculate_completeness(data)
    
    # 2. æº–ç¢ºæ€§å¾—åˆ†
    scores['accuracy'] = calculate_accuracy(data)
    
    # 3. ä¸€è‡´æ€§å¾—åˆ†
    scores['consistency'] = calculate_consistency(data)
    
    # 4. æ™‚æ•ˆæ€§å¾—åˆ†
    scores['timeliness'] = calculate_timeliness(data)
    
    # 5. å”¯ä¸€æ€§å¾—åˆ†
    scores['uniqueness'] = calculate_uniqueness(data)
    
    # åŠ æ¬Šç¸½åˆ†
    total_score = sum(scores[dim] * weights[dim] 
                     for dim in scores)
    
    return {
        'total_score': round(total_score, 2),
        'dimension_scores': scores,
        'grade': get_grade(total_score)
    }

def get_grade(score):
    """è³ªé‡è©•ç´š"""
    if score >= 95:
        return 'A+'
    elif score >= 90:
        return 'A'
    elif score >= 85:
        return 'B+'
    elif score >= 80:
        return 'B'
    elif score >= 70:
        return 'C'
    else:
        return 'D'
```

#### è©³ç´°è©•åˆ†è¨ˆç®—

```python
# 1. å®Œæ•´æ€§è©•åˆ†
def calculate_completeness(data):
    null_rate = data.isnull().sum().sum() / (len(data) * len(data.columns))
    return (1 - null_rate) * 100

# 2. æº–ç¢ºæ€§è©•åˆ†
def calculate_accuracy(data, rules):
    valid_count = 0
    total_count = len(data)
    
    for rule in rules:
        valid_count += data[rule].sum()
    
    return (valid_count / (total_count * len(rules))) * 100

# 3. ä¸€è‡´æ€§è©•åˆ†
def calculate_consistency(data, constraints):
    consistent_count = 0
    total_checks = 0
    
    for constraint in constraints:
        result = check_constraint(data, constraint)
        consistent_count += result['passed']
        total_checks += result['total']
    
    return (consistent_count / total_checks) * 100

# 4. æ™‚æ•ˆæ€§è©•åˆ†
def calculate_timeliness(data, sla_hours=24):
    now = datetime.now()
    delays = (now - data['updated_at']).dt.total_seconds() / 3600
    on_time = (delays <= sla_hours).sum()
    return (on_time / len(data)) * 100

# 5. å”¯ä¸€æ€§è©•åˆ†
def calculate_uniqueness(data, key_columns):
    duplicates = data.duplicated(subset=key_columns).sum()
    return (1 - duplicates / len(data)) * 100
```

### 5.2 è¶¨å‹¢åˆ†æ

#### è¶¨å‹¢æŒ‡æ¨™

```python
trend_analysis = {
    "time_periods": ["hour", "day", "week", "month"],
    
    "metrics": [
        {
            "name": "quality_score_trend",
            "description": "è³ªé‡åˆ†æ•¸è¶¨å‹¢",
            "calculation": "moving_average",
            "window": 7  # 7å¤©ç§»å‹•å¹³å‡
        },
        {
            "name": "error_rate_trend",
            "description": "éŒ¯èª¤ç‡è¶¨å‹¢",
            "calculation": "cumulative",
            "alert_threshold": 0.05
        },
        {
            "name": "improvement_rate",
            "description": "æ”¹å–„é€Ÿåº¦",
            "calculation": "(current_score - last_score) / last_score",
            "target": 0.02  # æ¯é€±æ”¹å–„ 2%
        }
    ],
    
    "detection": {
        "methods": ["linear_regression", "arima", "prophet"],
        "anomaly_threshold": 2.0  # 2å€‹æ¨™æº–å·®
    }
}
```

### 5.3 å°æ¯”åˆ†æ

#### å°æ¯”ç¶­åº¦

```python
comparison_analysis = {
    # æ™‚é–“å°æ¯”
    "temporal": {
        "today_vs_yesterday": {
            "metrics": ["quality_score", "error_count", "clean_rate"],
            "highlight_threshold": 0.05  # è®ŠåŒ– > 5% é«˜äº®
        },
        "this_week_vs_last_week": {},
        "month_over_month": {}
    },
    
    # ä¾†æºå°æ¯”
    "by_source": {
        "datasources": ["ch8_crawler", "ch1_api", "external"],
        "metrics": ["quality_score", "volume", "error_rate"],
        "rank_by": "quality_score"
    },
    
    # åˆ†é¡å°æ¯”
    "by_category": {
        "categories": ["product", "order", "user", "content"],
        "show_bottom_n": 5,  # é¡¯ç¤ºæœ€å·®çš„5å€‹
        "alert_threshold": 80  # ä½æ–¼80åˆ†å‘Šè­¦
    }
}
```

### 5.4 è©•åˆ†æ¨¡å‹ç®¡ç†

#### æ¨¡å‹é…ç½®

```yaml
scoring_models:
  - name: "default_model"
    version: "1.0"
    weights:
      completeness: 0.25
      accuracy: 0.30
      consistency: 0.20
      timeliness: 0.15
      uniqueness: 0.10
    active: true
    
  - name: "ecommerce_model"
    version: "1.0"
    weights:
      completeness: 0.20
      accuracy: 0.35  # é›»å•†æ›´é‡è¦–æº–ç¢ºæ€§
      consistency: 0.25
      timeliness: 0.15
      uniqueness: 0.05
    apply_to:
      - "products"
      - "orders"
    
  - name: "content_model"
    version: "1.0"
    weights:
      completeness: 0.30
      accuracy: 0.25
      consistency: 0.15
      timeliness: 0.20  # å…§å®¹æ›´é‡è¦–æ™‚æ•ˆæ€§
      uniqueness: 0.10
    apply_to:
      - "articles"
      - "posts"
```

---

## 6ï¸âƒ£ æ•¸æ“šè¡€ç·£åŠŸèƒ½

### 6.1 è¡€ç·£è¿½è¹¤

#### å…ƒæ•¸æ“šæ¡é›†

```python
lineage_metadata = {
    "data_source": {
        "id": "source_001",
        "name": "ch8_crawler_product",
        "type": "crawler",
        "schema": {...},
        "location": "kafka://topic/products"
    },
    
    "transformation": {
        "id": "transform_001",
        "name": "product_cleaning",
        "type": "data_cleaning",
        "operations": [
            "deduplication",
            "format_normalization",
            "missing_value_fill"
        ],
        "code": "etl/clean_product.py",
        "parameters": {...}
    },
    
    "data_target": {
        "id": "target_001",
        "name": "dw_product",
        "type": "table",
        "database": "data_warehouse",
        "table": "products"
    },
    
    "lineage": {
        "upstream": ["source_001"],
        "downstream": ["target_001"],
        "transformations": ["transform_001"]
    }
}
```

### 6.2 å½±éŸ¿åˆ†æ

#### å½±éŸ¿ç¯„åœè©•ä¼°

```python
def impact_analysis(entity_id, direction="downstream"):
    """
    åˆ†ææ•¸æ“šè®Šæ›´çš„å½±éŸ¿ç¯„åœ
    
    Args:
        entity_id: æ•¸æ“šå¯¦é«”ID
        direction: "upstream" (ä¸Šæ¸¸) æˆ– "downstream" (ä¸‹æ¸¸)
    
    Returns:
        å½±éŸ¿çš„å¯¦é«”åˆ—è¡¨åŠå½±éŸ¿ç¨‹åº¦
    """
    if direction == "downstream":
        # ä¸‹æ¸¸å½±éŸ¿åˆ†æ
        affected = find_downstream_entities(entity_id)
        
        impact_report = {
            "direct_impact": [],    # ç›´æ¥å½±éŸ¿
            "indirect_impact": [],  # é–“æ¥å½±éŸ¿
            "severity": "high",     # high, medium, low
            "affected_systems": [],
            "affected_users": []
        }
        
        for entity in affected:
            level = calculate_impact_level(entity)
            if level == 1:
                impact_report["direct_impact"].append(entity)
            else:
                impact_report["indirect_impact"].append(entity)
        
        return impact_report
    
    else:
        # ä¸Šæ¸¸è¿½æº¯åˆ†æ
        sources = find_upstream_entities(entity_id)
        
        trace_report = {
            "root_sources": [],     # æ ¹æºæ•¸æ“š
            "transformations": [],  # è½‰æ›éˆè·¯
            "data_quality": {}      # å„ç¯€é»è³ªé‡
        }
        
        return trace_report
```

### 6.3 è·¯å¾‘æŸ¥è©¢

#### æŸ¥è©¢é¡å‹

```python
# 1. ç«¯åˆ°ç«¯è·¯å¾‘æŸ¥è©¢
def find_path(source_id, target_id):
    """æŸ¥æ‰¾å¾æºåˆ°ç›®æ¨™çš„æ‰€æœ‰è·¯å¾‘"""
    paths = []
    graph = build_lineage_graph()
    
    all_paths = nx.all_simple_paths(
        graph, 
        source=source_id, 
        target=target_id
    )
    
    for path in all_paths:
        paths.append({
            "path": path,
            "length": len(path),
            "transformations": get_transformations_on_path(path)
        })
    
    return sorted(paths, key=lambda x: x['length'])

# 2. æœ€çŸ­è·¯å¾‘æŸ¥è©¢
def find_shortest_path(source_id, target_id):
    """æŸ¥æ‰¾æœ€çŸ­è·¯å¾‘"""
    graph = build_lineage_graph()
    path = nx.shortest_path(graph, source_id, target_id)
    return path

# 3. é—œéµè·¯å¾‘æŸ¥è©¢
def find_critical_path(entity_id):
    """æŸ¥æ‰¾é—œéµè·¯å¾‘ï¼ˆå½±éŸ¿æœ€å¤§çš„è·¯å¾‘ï¼‰"""
    graph = build_lineage_graph()
    paths = nx.all_simple_paths(graph, entity_id, None)
    
    critical_paths = []
    for path in paths:
        importance = calculate_path_importance(path)
        if importance > threshold:
            critical_paths.append({
                "path": path,
                "importance": importance
            })
    
    return sorted(critical_paths, key=lambda x: x['importance'], reverse=True)
```

### 6.4 è¡€ç·£å¯è¦–åŒ–

#### å¯è¦–åŒ–é…ç½®

```javascript
lineage_visualization = {
    // åœ–å½¢å¸ƒå±€
    "layout": {
        "type": "dagre",  // dagre, force, tree
        "direction": "LR",  // LR (å·¦å³), TB (ä¸Šä¸‹)
        "rankSep": 100,
        "nodeSep": 50
    },
    
    // ç¯€é»æ¨£å¼
    "node_style": {
        "source": {
            "shape": "cylinder",
            "color": "#4CAF50",
            "icon": "database"
        },
        "transformation": {
            "shape": "rect",
            "color": "#2196F3",
            "icon": "transform"
        },
        "target": {
            "shape": "cylinder",
            "color": "#FF9800",
            "icon": "storage"
        }
    },
    
    // é‚Šæ¨£å¼
    "edge_style": {
        "default": {
            "type": "bezier",
            "arrow": true,
            "width": 2
        },
        "high_volume": {
            "width": 4,
            "color": "#F44336"
        }
    },
    
    // äº¤äº’åŠŸèƒ½
    "interactions": {
        "click_node": "show_details",
        "hover_node": "show_tooltip",
        "double_click": "expand_collapse"
    }
}
```

---

## 7ï¸âƒ£ è³ªé‡å ±å‘ŠåŠŸèƒ½

### 7.1 å®šæœŸå ±å‘Š

#### å ±å‘Šé¡å‹

| å ±å‘Šé¡å‹ | é »ç‡ | å…§å®¹ | å—çœ¾ |
|---------|------|------|------|
| **å¯¦æ™‚çœ‹æ¿** | å¯¦æ™‚ | ç•¶å‰è³ªé‡ç‹€æ…‹ | é‹ç¶­äººå“¡ |
| **æ—¥å ±** | æ¯å¤© | ç•¶æ—¥è³ªé‡çµ±è¨ˆ | åœ˜éšŠæˆå“¡ |
| **é€±å ±** | æ¯é€± | é€±è³ªé‡è¶¨å‹¢ | é …ç›®ç¶“ç† |
| **æœˆå ±** | æ¯æœˆ | æœˆåº¦è³ªé‡åˆ†æ | ç®¡ç†å±¤ |
| **å­£åº¦å ±å‘Š** | æ¯å­£ | è³ªé‡æ”¹é€²ç¸½çµ | é«˜å±¤é ˜å° |

#### æ—¥å ±æ¨¡æ¿

```markdown
# æ•¸æ“šè³ªé‡æ—¥å ± - 2025-10-31

## ğŸ“Š è³ªé‡ç¸½è¦½

- **æ•´é«”è³ªé‡åˆ†æ•¸**: 95.2åˆ† (â†‘ +2.3)
- **æ•¸æ“šè™•ç†é‡**: 1,250,000 æ¢
- **æ¸…æ´—æ•¸æ“šé‡**: 125,000 æ¢ (10%)
- **ç•°å¸¸æ•¸æ“šé‡**: 12,500 æ¢ (1%)

## ğŸ“ˆ äº”ç¶­è³ªé‡å¾—åˆ†

| ç¶­åº¦ | å¾—åˆ† | è®ŠåŒ– | è©•ç´š |
|-----|------|------|------|
| å®Œæ•´æ€§ | 98åˆ† | - | A+ |
| æº–ç¢ºæ€§ | 96åˆ† | â†‘ +3 | A |
| ä¸€è‡´æ€§ | 94åˆ† | â†‘ +1 | A |
| æ™‚æ•ˆæ€§ | 92åˆ† | â†“ -2 | A- |
| å”¯ä¸€æ€§ | 97åˆ† | - | A+ |

## ğŸ” ä¸»è¦å•é¡Œ

1. **URLæ ¼å¼éŒ¯èª¤** (15,000æ¢)
   - ä¾†æº: Ch8-çˆ¬èŸ²-ç«™é»C
   - å½±éŸ¿: 1.2% æ•¸æ“š
   - ç‹€æ…‹: è¦å‰‡å·²æ›´æ–°

2. **åƒ¹æ ¼è¶…å‡ºç¯„åœ** (8,000æ¢)
   - ä¾†æº: Ch1-API-ä¾›æ‡‰å•†B
   - å½±éŸ¿: 0.6% æ•¸æ“š
   - ç‹€æ…‹: å¾…äººå·¥å¯©æ ¸

3. **åœ–ç‰‡URLç¼ºå¤±** (5,000æ¢)
   - ä¾†æº: Ch8-çˆ¬èŸ²-ç«™é»A
   - å½±éŸ¿: 0.4% æ•¸æ“š
   - ç‹€æ…‹: è‡ªå‹•è£œå……é»˜èªåœ–

## ğŸ’¡ æ”¹é€²å»ºè­°

1. å„ªåŒ–ç«™é»Cçš„URLæå–è¦å‰‡
2. èˆ‡ä¾›æ‡‰å•†Bæºé€šåƒ¹æ ¼æ•¸æ“šè¦ç¯„
3. å¢åŠ åœ–ç‰‡URLçš„å¿…å¡«é©—è­‰

## ğŸ“… æ˜æ—¥è¨ˆåŠƒ

- éƒ¨ç½²æ–°çš„æ¸…æ´—è¦å‰‡
- ç›£æ§ä¾›æ‡‰å•†Bæ•¸æ“šè³ªé‡
- ç”Ÿæˆé€±åº¦è¶¨å‹¢å ±å‘Š
```

### 7.2 å•é¡Œå ±å‘Š

#### å•é¡Œå ±å‘Šçµæ§‹

```python
issue_report = {
    "issue_id": "QI-2025-10-31-001",
    "title": "Ch8çˆ¬èŸ²ç«™é»C URLæ ¼å¼éŒ¯èª¤",
    "severity": "medium",  # critical, high, medium, low
    "status": "open",      # open, in_progress, resolved, closed
    
    "detection": {
        "detected_at": "2025-10-31 14:30:00",
        "detection_method": "regex_validation",
        "affected_records": 15000
    },
    
    "impact": {
        "data_sources": ["ch8_crawler_site_c"],
        "downstream_systems": ["data_warehouse", "api_service"],
        "business_impact": "éƒ¨åˆ†ç”¢å“ä¿¡æ¯ç„¡æ³•å±•ç¤º"
    },
    
    "root_cause": {
        "category": "source_change",
        "description": "ç›®æ¨™ç¶²ç«™æ”¹ç‰ˆï¼ŒURLçµæ§‹è®Šæ›´",
        "evidence": [
            "URL pattern changed from /product/id to /item/id",
            "Detected on 2025-10-31 14:00"
        ]
    },
    
    "resolution": {
        "assigned_to": "data_team",
        "action_items": [
            "æ›´æ–°çˆ¬èŸ²URLæå–è¦å‰‡",
            "å›å¡«ä¿®æ­£æ­·å²æ•¸æ“š",
            "æ·»åŠ URLæ ¼å¼ç›£æ§"
        ],
        "estimated_time": "2å°æ™‚",
        "priority": "high"
    },
    
    "timeline": [
        {"time": "14:30", "event": "å•é¡Œæª¢æ¸¬"},
        {"time": "14:35", "event": "å‘Šè­¦ç™¼é€"},
        {"time": "14:40", "event": "å•é¡Œç¢ºèª"},
        {"time": "15:00", "event": "ä¿®å¾©é–‹å§‹"},
        {"time": "16:30", "event": "ä¿®å¾©å®Œæˆ"},
        {"time": "17:00", "event": "é©—è­‰é€šé"}
    ]
}
```

### 7.3 è¶¨å‹¢å ±å‘Š

#### é€±åº¦è¶¨å‹¢å ±å‘Š

```python
weekly_trend_report = {
    "period": {
        "start_date": "2025-10-25",
        "end_date": "2025-10-31",
        "week_number": 44
    },
    
    "quality_trend": {
        "overall_score": {
            "current": 95.2,
            "last_week": 93.5,
            "change": +1.7,
            "trend": "improving"
        },
        "daily_scores": [
            {"date": "10-25", "score": 93.5},
            {"date": "10-26", "score": 94.1},
            {"date": "10-27", "score": 94.8},
            {"date": "10-28", "score": 95.0},
            {"date": "10-29", "score": 94.5},
            {"date": "10-30", "score": 95.8},
            {"date": "10-31", "score": 95.2}
        ]
    },
    
    "volume_trend": {
        "total_records": 8750000,
        "daily_average": 1250000,
        "peak_day": {"date": "10-30", "records": 1450000},
        "low_day": {"date": "10-29", "records": 1050000}
    },
    
    "issue_trend": {
        "total_issues": 47,
        "resolved_issues": 42,
        "resolution_rate": 0.894,
        "avg_resolution_time": "3.5 hours",
        "top_issue_types": [
            {"type": "format_error", "count": 18},
            {"type": "missing_value", "count": 12},
            {"type": "duplicate", "count": 10}
        ]
    },
    
    "highlights": [
        "è³ªé‡åˆ†æ•¸é€£çºŒ7å¤©ä¿æŒåœ¨90åˆ†ä»¥ä¸Š",
        "URLæ ¼å¼éŒ¯èª¤æ¸›å°‘60%",
        "è‡ªå‹•æ¸…æ´—æˆåŠŸç‡æå‡è‡³98%"
    ],
    
    "concerns": [
        "é€±æœ«æ•¸æ“šå»¶é²å¢åŠ ",
        "ä¾›æ‡‰å•†Bæ•¸æ“šè³ªé‡æ³¢å‹•å¤§"
    ]
}
```

### 7.4 è‡ªå®šç¾©å ±å‘Š

#### å ±å‘Šæ§‹å»ºå™¨

```python
class ReportBuilder:
    def __init__(self):
        self.report = {
            "title": "",
            "sections": [],
            "filters": {},
            "format": "html"
        }
    
    def set_title(self, title):
        """è¨­ç½®å ±å‘Šæ¨™é¡Œ"""
        self.report["title"] = title
        return self
    
    def add_metric_section(self, name, metrics):
        """æ·»åŠ æŒ‡æ¨™éƒ¨åˆ†"""
        section = {
            "type": "metrics",
            "name": name,
            "data": metrics
        }
        self.report["sections"].append(section)
        return self
    
    def add_chart_section(self, name, chart_type, data):
        """æ·»åŠ åœ–è¡¨éƒ¨åˆ†"""
        section = {
            "type": "chart",
            "name": name,
            "chart_type": chart_type,  # line, bar, pie, radar
            "data": data
        }
        self.report["sections"].append(section)
        return self
    
    def add_table_section(self, name, columns, data):
        """æ·»åŠ è¡¨æ ¼éƒ¨åˆ†"""
        section = {
            "type": "table",
            "name": name,
            "columns": columns,
            "data": data
        }
        self.report["sections"].append(section)
        return self
    
    def add_filter(self, key, value):
        """æ·»åŠ éæ¿¾æ¢ä»¶"""
        self.report["filters"][key] = value
        return self
    
    def set_format(self, format_type):
        """è¨­ç½®è¼¸å‡ºæ ¼å¼"""
        self.report["format"] = format_type  # html, pdf, excel, json
        return self
    
    def generate(self):
        """ç”Ÿæˆå ±å‘Š"""
        if self.report["format"] == "html":
            return self._generate_html()
        elif self.report["format"] == "pdf":
            return self._generate_pdf()
        elif self.report["format"] == "excel":
            return self._generate_excel()
        else:
            return self.report

# ä½¿ç”¨ç¤ºä¾‹
report = (ReportBuilder()
    .set_title("é›»å•†æ•¸æ“šè³ªé‡å°ˆé …å ±å‘Š")
    .add_filter("date_range", ["2025-10-01", "2025-10-31"])
    .add_filter("data_source", "ch8_crawler")
    .add_metric_section("è³ªé‡æ¦‚è¦½", {
        "total_score": 95.2,
        "total_records": 10000000,
        "error_rate": 0.012
    })
    .add_chart_section("è³ªé‡è¶¨å‹¢", "line", quality_trend_data)
    .add_table_section("Top å•é¡Œ", ["å•é¡Œ", "æ•¸é‡", "å æ¯”"], top_issues)
    .set_format("pdf")
    .generate()
)
```

---

## 8ï¸âƒ£ ä¿®å¾©ç®¡ç†åŠŸèƒ½

### 8.1 è‡ªå‹•ä¿®å¾©

#### è‡ªå‹•ä¿®å¾©è¦å‰‡

```python
auto_fix_rules = {
    # æ ¼å¼ä¿®å¾©
    "format_fixes": [
        {
            "name": "url_normalize",
            "condition": "invalid_url_format",
            "action": "normalize_url",
            "confidence": 0.95
        },
        {
            "name": "date_format",
            "condition": "date_format_inconsistent",
            "action": "convert_to_iso8601",
            "confidence": 0.99
        },
        {
            "name": "phone_format",
            "condition": "phone_format_invalid",
            "action": "format_phone_number",
            "confidence": 0.90
        }
    ],
    
    # ç¼ºå¤±å€¼ä¿®å¾©
    "missing_value_fixes": [
        {
            "name": "fill_default_category",
            "condition": "category_missing",
            "action": "fill_with_default",
            "value": "æœªåˆ†é¡",
            "confidence": 0.80
        },
        {
            "name": "predict_age",
            "condition": "age_missing",
            "action": "model_predict",
            "model": "age_predictor",
            "confidence": 0.75
        }
    ],
    
    # ç•°å¸¸å€¼ä¿®å¾©
    "outlier_fixes": [
        {
            "name": "price_cap",
            "condition": "price_too_high",
            "action": "cap_at_percentile",
            "percentile": 99,
            "confidence": 0.85
        },
        {
            "name": "negative_quantity",
            "condition": "quantity < 0",
            "action": "set_to_zero",
            "confidence": 0.95
        }
    ],
    
    # é‡è¤‡è™•ç†
    "duplicate_fixes": [
        {
            "name": "remove_exact_duplicates",
            "condition": "exact_duplicate",
            "action": "keep_first",
            "confidence": 1.00
        },
        {
            "name": "merge_similar_records",
            "condition": "similarity > 0.95",
            "action": "merge_records",
            "strategy": "keep_most_complete",
            "confidence": 0.85
        }
    ]
}
```

#### ä¿®å¾©åŸ·è¡Œæµç¨‹

```python
def auto_fix_pipeline(data, rules):
    """
    è‡ªå‹•ä¿®å¾©ç®¡é“
    """
    fix_log = []
    
    for record in data:
        for rule in rules:
            # æª¢æŸ¥æ¢ä»¶
            if check_condition(record, rule['condition']):
                
                # æª¢æŸ¥ç½®ä¿¡åº¦é–¾å€¼
                if rule['confidence'] >= AUTO_FIX_THRESHOLD:
                    # è‡ªå‹•ä¿®å¾©
                    fixed_record = apply_fix(record, rule['action'])
                    
                    # è¨˜éŒ„ä¿®å¾©æ—¥èªŒ
                    fix_log.append({
                        'record_id': record['id'],
                        'rule': rule['name'],
                        'original': record,
                        'fixed': fixed_record,
                        'confidence': rule['confidence'],
                        'auto_applied': True
                    })
                    
                    record = fixed_record
                else:
                    # ç½®ä¿¡åº¦ä¸è¶³ï¼Œæ¨™è¨˜ç‚ºå¾…å¯©æ ¸
                    fix_log.append({
                        'record_id': record['id'],
                        'rule': rule['name'],
                        'suggested_fix': get_suggested_fix(record, rule),
                        'confidence': rule['confidence'],
                        'auto_applied': False,
                        'status': 'pending_review'
                    })
    
    return data, fix_log
```

### 8.2 ä¿®å¾©å»ºè­°

#### å»ºè­°ç”Ÿæˆ

```python
def generate_fix_suggestions(issues):
    """
    ç”Ÿæˆä¿®å¾©å»ºè­°
    """
    suggestions = []
    
    for issue in issues:
        suggestion = {
            'issue_id': issue['id'],
            'issue_type': issue['type'],
            'affected_records': issue['count'],
            'severity': issue['severity'],
            'suggestions': []
        }
        
        # æ ¹æ“šå•é¡Œé¡å‹ç”Ÿæˆå»ºè­°
        if issue['type'] == 'format_error':
            suggestion['suggestions'].append({
                'method': 'auto_fix',
                'description': 'ä½¿ç”¨è¦å‰‡å¼•æ“è‡ªå‹•ä¿®æ­£æ ¼å¼',
                'confidence': 0.90,
                'estimated_time': '5åˆ†é˜',
                'risk': 'low'
            })
            suggestion['suggestions'].append({
                'method': 'manual_review',
                'description': 'äººå·¥å¯©æ ¸ä¸¦æ‰¹é‡ä¿®æ­£',
                'confidence': 1.00,
                'estimated_time': '2å°æ™‚',
                'risk': 'none'
            })
        
        elif issue['type'] == 'missing_value':
            suggestion['suggestions'].append({
                'method': 'model_predict',
                'description': 'ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’æ¨¡å‹é æ¸¬ç¼ºå¤±å€¼',
                'confidence': 0.75,
                'estimated_time': '30åˆ†é˜',
                'risk': 'medium'
            })
            suggestion['suggestions'].append({
                'method': 'default_fill',
                'description': 'å¡«å……é»˜èªå€¼',
                'confidence': 0.60,
                'estimated_time': '1åˆ†é˜',
                'risk': 'low'
            })
        
        elif issue['type'] == 'duplicate':
            suggestion['suggestions'].append({
                'method': 'auto_dedup',
                'description': 'è‡ªå‹•å»é‡ï¼ˆä¿ç•™æœ€æ–°è¨˜éŒ„ï¼‰',
                'confidence': 0.95,
                'estimated_time': '10åˆ†é˜',
                'risk': 'low'
            })
        
        suggestions.append(suggestion)
    
    return suggestions
```

### 8.3 äººå·¥å¯©æ ¸

#### å¯©æ ¸å·¥ä½œæµ

```
å•é¡Œæª¢æ¸¬
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è‡ªå‹•åˆ†é¡        â”‚
â”‚ â€¢ å¯è‡ªå‹•ä¿®å¾©    â”‚ â†’ è‡ªå‹•ä¿®å¾© â†’ é©—è­‰ â†’ å®Œæˆ
â”‚ â€¢ éœ€äººå·¥å¯©æ ¸    â”‚ â†’ é€²å…¥å¯©æ ¸éšŠåˆ—
â”‚ â€¢ ç„¡æ³•ä¿®å¾©      â”‚ â†’ æ¨™è¨˜å¾…è™•ç†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯©æ ¸éšŠåˆ—        â”‚
â”‚ â€¢ æŒ‰å„ªå…ˆç´šæ’åº  â”‚
â”‚ â€¢ åˆ†é…å¯©æ ¸äºº    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äººå·¥å¯©æ ¸        â”‚
â”‚ â€¢ æŸ¥çœ‹å•é¡Œè©³æƒ…  â”‚
â”‚ â€¢ é¸æ“‡ä¿®å¾©æ–¹æ¡ˆ  â”‚
â”‚ â€¢ æ‰¹é‡è™•ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŸ·è¡Œä¿®å¾©        â”‚
â”‚ â€¢ æ‡‰ç”¨ä¿®å¾©      â”‚
â”‚ â€¢ è¨˜éŒ„æ—¥èªŒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é©—è­‰çµæœ        â”‚
â”‚ â€¢ è³ªé‡æª¢æŸ¥      â”‚
â”‚ â€¢ å½±éŸ¿è©•ä¼°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å®Œæˆ
```

#### å¯©æ ¸ç•Œé¢

```javascript
review_interface = {
    // å•é¡Œåˆ—è¡¨
    "issue_list": {
        "columns": [
            "å„ªå…ˆç´š",
            "å•é¡Œé¡å‹",
            "å½±éŸ¿è¨˜éŒ„æ•¸",
            "æ•¸æ“šæº",
            "æª¢æ¸¬æ™‚é–“",
            "ç‹€æ…‹"
        ],
        "filters": ["é¡å‹", "åš´é‡ç¨‹åº¦", "æ•¸æ“šæº", "ç‹€æ…‹"],
        "sort_by": "priority",
        "bulk_actions": ["æ‰¹é‡ä¿®å¾©", "æ‰¹é‡å¿½ç•¥", "å°å‡º"]
    },
    
    // å•é¡Œè©³æƒ…
    "issue_details": {
        "tabs": [
            "åŸºæœ¬ä¿¡æ¯",
            "å—å½±éŸ¿æ•¸æ“š",
            "ä¿®å¾©å»ºè­°",
            "å½±éŸ¿åˆ†æ",
            "æ­·å²è¨˜éŒ„"
        ],
        "actions": ["æ‡‰ç”¨ä¿®å¾©", "è‡ªå®šç¾©ä¿®å¾©", "å¿½ç•¥", "é‡æ–°æª¢æ¸¬"]
    },
    
    // ä¿®å¾©ç¢ºèª
    "fix_confirmation": {
        "preview": "é¡¯ç¤ºä¿®å¾©å‰å¾Œå°æ¯”",
        "impact": "é¡¯ç¤ºå½±éŸ¿ç¯„åœ",
        "rollback": "æ”¯æŒå›æ»¾æ“ä½œ"
    }
}
```

### 8.4 ä¿®å¾©è¿½è¹¤

#### ä¿®å¾©è¨˜éŒ„

```python
fix_record = {
    "fix_id": "FIX-2025-10-31-001",
    "issue_id": "QI-2025-10-31-001",
    "fix_type": "auto",  # auto, manual, hybrid
    
    "fix_details": {
        "method": "regex_replace",
        "rule": "url_normalize_rule_v2",
        "affected_records": 15000,
        "success_records": 14850,
        "failed_records": 150
    },
    
    "execution": {
        "started_at": "2025-10-31 15:00:00",
        "completed_at": "2025-10-31 15:12:00",
        "duration_seconds": 720,
        "executed_by": "auto_fix_engine"
    },
    
    "validation": {
        "validation_passed": True,
        "quality_score_before": 85.2,
        "quality_score_after": 95.1,
        "improvement": +9.9
    },
    
    "rollback_info": {
        "rollbackable": True,
        "backup_location": "s3://backups/2025-10-31/fix-001",
        "retention_days": 30
    }
}
```

---

## 9ï¸âƒ£ é…ç½®ç®¡ç†åŠŸèƒ½

### 9.1 è¦å‰‡é…ç½®

#### è¦å‰‡é…ç½®ç•Œé¢

```yaml
rule_configuration:
  # è¦å‰‡åŸºæœ¬ä¿¡æ¯
  metadata:
    name: "email_validation"
    version: "1.0"
    category: "format_validation"
    description: "é©—è­‰éƒµç®±æ ¼å¼æ˜¯å¦æ­£ç¢º"
    created_by: "data_team"
    created_at: "2025-10-01"
    
  # è¦å‰‡å®šç¾©
  rule:
    type: "regex"
    field: "email"
    pattern: "^[\\w\\.-]+@[\\w\\.-]+\\.\\w+$"
    case_sensitive: false
    
  # åŸ·è¡Œé…ç½®
  execution:
    enabled: true
    priority: "high"
    execution_mode: "real_time"  # real_time, batch
    
  # ç•°å¸¸è™•ç†
  on_failure:
    severity: "error"
    action: "reject"  # reject, warn, fix, ignore
    notification: true
    
  # é©ç”¨ç¯„åœ
  scope:
    data_sources: ["ch8_crawler", "ch1_api"]
    tables: ["users", "customers"]
    
  # èª¿åº¦é…ç½®
  schedule:
    frequency: "continuous"  # continuous, hourly, daily
    start_time: null
    end_time: null
```

### 9.2 é–¾å€¼é…ç½®

#### è³ªé‡é–¾å€¼è¨­ç½®

```yaml
quality_thresholds:
  # æ•´é«”è³ªé‡é–¾å€¼
  overall:
    excellent: 95    # >= 95åˆ†ç‚ºå„ªç§€
    good: 85         # >= 85åˆ†ç‚ºè‰¯å¥½
    acceptable: 70   # >= 70åˆ†ç‚ºå¯æ¥å—
    poor: 70         # < 70åˆ†ç‚ºå·®
    
  # å„ç¶­åº¦é–¾å€¼
  dimensions:
    completeness:
      target: 98
      minimum: 90
      alert_threshold: 85
      
    accuracy:
      target: 95
      minimum: 90
      alert_threshold: 85
      
    consistency:
      target: 95
      minimum: 85
      alert_threshold: 80
      
    timeliness:
      target: 90
      minimum: 80
      alert_threshold: 70
      
    uniqueness:
      target: 99
      minimum: 95
      alert_threshold: 90
  
  # ç•°å¸¸æª¢æ¸¬é–¾å€¼
  anomaly_detection:
    statistical:
      z_score_threshold: 3.0
      iqr_multiplier: 1.5
      mad_threshold: 3.5
      
    ml_based:
      isolation_forest_contamination: 0.1
      lof_n_neighbors: 20
      ensemble_threshold: 0.7
  
  # å‘Šè­¦é–¾å€¼
  alerts:
    critical:
      quality_drop: 10        # è³ªé‡ä¸‹é™10åˆ†
      error_rate: 0.05        # éŒ¯èª¤ç‡5%
      duplicate_rate: 0.10    # é‡è¤‡ç‡10%
      
    warning:
      quality_drop: 5
      error_rate: 0.02
      duplicate_rate: 0.05
      
    info:
      quality_drop: 2
      error_rate: 0.01
      duplicate_rate: 0.02
```

### 9.3 ç­–ç•¥é…ç½®

#### æ¸…æ´—ç­–ç•¥

```yaml
cleaning_strategies:
  # é»˜èªç­–ç•¥
  default:
    name: "standard_cleaning"
    stages:
      - deduplication
      - format_normalization
      - missing_value_handling
      - outlier_removal
      - validation
    
  # é›»å•†æ•¸æ“šç­–ç•¥
  ecommerce:
    name: "ecommerce_cleaning"
    priority_checks:
      - price_validation
      - inventory_consistency
      - product_completeness
    stages:
      - exact_deduplication
      - price_normalization
      - category_standardization
      - image_url_validation
      - description_quality_check
    
  # å…§å®¹æ•¸æ“šç­–ç•¥
  content:
    name: "content_cleaning"
    priority_checks:
      - duplicate_detection
      - language_detection
      - content_quality
    stages:
      - fuzzy_deduplication
      - html_cleaning
      - text_normalization
      - metadata_extraction
      
  # ç”¨æˆ¶æ•¸æ“šç­–ç•¥
  user:
    name: "user_data_cleaning"
    priority_checks:
      - pii_protection
      - data_consistency
    stages:
      - exact_deduplication
      - email_normalization
      - phone_normalization
      - address_standardization
      - data_masking
```

### 9.4 æ¨¡æ¿ç®¡ç†

#### é…ç½®æ¨¡æ¿

```python
configuration_templates = {
    # æ•¸æ“šæºæ¨¡æ¿
    "data_source_templates": [
        {
            "name": "crawler_data_source",
            "description": "çˆ¬èŸ²æ•¸æ“šæºæ¨™æº–é…ç½®",
            "config": {
                "quality_checks": [
                    "url_format",
                    "html_structure",
                    "content_completeness"
                ],
                "cleaning_strategy": "content",
                "validation_rules": "crawler_rules",
                "auto_fix_enabled": True,
                "alert_channels": ["slack", "email"]
            }
        },
        {
            "name": "api_data_source",
            "description": "APIæ•¸æ“šæºæ¨™æº–é…ç½®",
            "config": {
                "quality_checks": [
                    "json_schema",
                    "field_types",
                    "required_fields"
                ],
                "cleaning_strategy": "default",
                "validation_rules": "api_rules",
                "auto_fix_enabled": False,
                "alert_channels": ["email"]
            }
        }
    ],
    
    # è¦å‰‡é›†æ¨¡æ¿
    "rule_set_templates": [
        {
            "name": "basic_validation",
            "rules": [
                "non_null_check",
                "type_check",
                "format_check"
            ]
        },
        {
            "name": "advanced_validation",
            "rules": [
                "basic_validation",
                "business_logic_check",
                "cross_field_validation",
                "reference_integrity"
            ]
        }
    ],
    
    # å ±å‘Šæ¨¡æ¿
    "report_templates": [
        {
            "name": "daily_summary",
            "sections": [
                "quality_overview",
                "dimension_scores",
                "top_issues",
                "trend_analysis"
            ],
            "format": "html",
            "delivery": "email"
        },
        {
            "name": "executive_monthly",
            "sections": [
                "quality_summary",
                "key_achievements",
                "major_issues",
                "improvement_plan"
            ],
            "format": "pdf",
            "delivery": "email"
        }
    ]
}
```

---

## ğŸ“‘ åŠŸèƒ½å„ªå…ˆç´šçŸ©é™£

### é–‹ç™¼å„ªå…ˆç´š

| åŠŸèƒ½æ¨¡å¡Š | å„ªå…ˆç´š | è¤‡é›œåº¦ | é ä¼°å·¥æ™‚ | ä¾è³´é … |
|---------|--------|--------|---------|--------|
| **è³ªé‡ç›£æ§** | P0 | é«˜ | 40h | Kafka, InfluxDB |
| **æ•¸æ“šæ¸…æ´—** | P0 | é«˜ | 60h | Pandas, Spark |
| **è³ªé‡æ ¡é©—** | P0 | ä¸­ | 30h | è¦å‰‡å¼•æ“ |
| **è³ªé‡è©•åˆ†** | P1 | ä¸­ | 20h | - |
| **ç•°å¸¸æª¢æ¸¬** | P1 | é«˜ | 50h | MLåº« |
| **æ•¸æ“šè¡€ç·£** | P2 | é«˜ | 40h | Atlas |
| **è³ªé‡å ±å‘Š** | P1 | ä½ | 20h | - |
| **ä¿®å¾©ç®¡ç†** | P1 | ä¸­ | 30h | - |
| **é…ç½®ç®¡ç†** | P2 | ä¸­ | 20h | - |

**ç¸½è¨ˆ**: 310 å·¥æ™‚ (~2å€‹æœˆï¼Œ2äººåœ˜éšŠ)

---

## ğŸ“‘ ç›¸é—œç« ç¯€

| å‰åº | ç•¶å‰ | å¾ŒçºŒ |
|-----|------|------|
| [12.1 æ¨¡çµ„æ¦‚è¿°](ch12-1-æ¨¡çµ„æ¦‚è¿°.md) | **12.2 è©³ç´°åŠŸèƒ½æ¸…å–®** | [12.3 æŠ€è¡“æ¶æ§‹](ch12-3-æŠ€è¡“æ¶æ§‹.md) |

**å¿«é€Ÿéˆæ¥ï¼š**
- [12.1 æ¨¡çµ„æ¦‚è¿°](ch12-1-æ¨¡çµ„æ¦‚è¿°.md)
- [12.3 æŠ€è¡“æ¶æ§‹](ch12-3-æŠ€è¡“æ¶æ§‹.md)
- [12.4 æ ¸å¿ƒçµ„ä»¶è©³ç´°å¯¦ç¾](ch12-4-æ ¸å¿ƒçµ„ä»¶è©³ç´°å¯¦ç¾.md)
- [â† è¿”å›ç¬¬12ç« é¦–é ](ch12-index.md)

---

**æœ€å¾Œæ›´æ–°**: 2025-10-31  
**ç‰ˆæœ¬**: 1.0

